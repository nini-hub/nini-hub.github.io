<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/favicon.png" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"nini-hub.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="https://nini-hub.github.io/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="zh">
<meta property="article:author" content="妮妮妮">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://nini-hub.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh'
  };
</script>

  <title>Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="تشغيل شريط التصفح">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hexo</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://nini-hub.github.io/2020/12/11/%E4%B8%8A%E7%BA%BFnode%E9%A1%B9%E7%9B%AE%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="妮妮妮">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/11/%E4%B8%8A%E7%BA%BFnode%E9%A1%B9%E7%9B%AE%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">上线node项目笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">نُشر في</span>

              <time title="أُنشأ: 2020-12-11 14:28:20" itemprop="dateCreated datePublished" datetime="2020-12-11T14:28:20+08:00">2020-12-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">عُدل في</span>
                <time title="عُدل: 2020-12-14 09:09:11" itemprop="dateModified" datetime="2020-12-14T09:09:11+08:00">2020-12-14</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="cookie跨域问题"><a href="#cookie跨域问题" class="headerlink" title="cookie跨域问题"></a>cookie跨域问题</h4><ol>
<li><p>Cookie的跨域问题</p>
<p>Cookie是不能跨域使用的, 所以在前后端分离开发的时候, 我们当前的代码就会出现问题</p>
</li>
<li><p>什么是跨域?</p>
<p>协议/一级域名/二级域名/端口号 有一个不同就是跨域</p>
</li>
<li><p>如何解决前后端分离Cookie的跨域问题?</p>
<p>通过Nginx反向代理</p>
<p><a href="http://nginx.org/en/download.html" target="_blank" rel="noopener">http://nginx.org/en/download.html</a></p>
</li>
</ol>
<h4 id="正向代理和反向道理"><a href="#正向代理和反向道理" class="headerlink" title="正向代理和反向道理"></a>正向代理和反向道理</h4><h5 id="正向代理"><a href="#正向代理" class="headerlink" title="正向代理"></a>正向代理</h5><ol>
<li><p>代理服务器是为用户服务, 我们称之为正向代理</p>
<p>例如: 访问谷歌</p>
<p>用户访问不了谷歌, 但是我可以访问一台海外的服务器, 这台海外服务器又可以访问谷歌</p>
<p>那么’用户’就可以先访问’海外的服务器’, 再通过’海外的服务器’访问谷歌, 这就是正向代理</p>
</li>
<li><p>正向代理的用途</p>
<ul>
<li><p>访问原来无法访问的资源，如google</p>
</li>
<li><p>对客户端访问授权，上网进行认证</p>
</li>
<li><p>… …</p>
</li>
</ul>
</li>
</ol>
<pre class="mermaid">    graph LR
        subgraph Google服务器
        end
        subgraph 用户及代理服务器
        user1-->代理服务器
        user2-->代理服务器
        user3-->代理服务器
        end
        代理服务器-->Google服务器
        Google服务器-->代理服务器</pre>

<h5 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h5><ol>
<li><p>反向代理服务器是为’服务器’服务,我们称之为反向代理</p>
</li>
<li><p>反向代理的用途</p>
<ul>
<li><p>负载均衡，通过反向代理服务器来优化网站的负载</p>
</li>
<li><p>前后端分离, 统一请求地址</p>
</li>
</ul>
</li>
</ol>
<pre class="mermaid">    graph LR
        subgraph 用户
        user1
        user2
        user3
        end
        subgraph 前后端服务器及代理服务器
        代理服务器80-->前端服务器3001
        代理服务器80-->后端服务器3000
        end
        user1-->代理服务器80
        user2-->代理服务器80
        user3-->代理服务器80</pre>

<p>快出来啊啊啊啊啊</p>
<h4 id="nginx解决cookie跨域问题"><a href="#nginx解决cookie跨域问题" class="headerlink" title="nginx解决cookie跨域问题"></a>nginx解决cookie跨域问题</h4><h5 id="Nginx安装和使用"><a href="#Nginx安装和使用" class="headerlink" title="Nginx安装和使用"></a>Nginx安装和使用</h5><ol>
<li><p>安装</p>
<p>下载解压即可</p>
<p><a href="http://nginx.org/en/download.html" target="_blank" rel="noopener">http://nginx.org/en/download.html</a></p>
</li>
<li><p>使用</p>
<p>修改配置文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">worker_processes <span class="number">4</span>; <span class="comment">// CPU核数</span></span><br><span class="line"></span><br><span class="line">location / &#123; <span class="comment">// 请求根路径代理的地址</span></span><br><span class="line"></span><br><span class="line"> proxy_pass http:<span class="comment">//192.168.0.107:3001;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location /api &#123; <span class="comment">// 请求/api代理的地址</span></span><br><span class="line"></span><br><span class="line"> proxy_pass http:<span class="comment">//127.0.0.1:3000;</span></span><br><span class="line"></span><br><span class="line"> proxy_set_header Host $host;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="PM2"><a href="#PM2" class="headerlink" title="PM2"></a>PM2</h4><ol>
<li><p>如何上线Node编写的项目?</p>
<p>上线项目需要考虑的几个问题</p>
<ul>
<li>服务稳定性, 不会因为程序的某个错误或异常导致项目停止服务</li>
<li>线上日志记录, 除了记录访问日志以外, 我们还需要记录错误日志和自定义日志</li>
<li>充分利用服务器资源, Node是单线程的, 服务器是多核的, 一台服务器只运行一个Node程序太浪费资源</li>
</ul>
</li>
<li><p>如何解决上述问题?</p>
<p>通过<strong>PM2</strong></p>
<ul>
<li><p>PM2的进程守护可以在程序崩溃后自动重启</p>
</li>
<li><p>PM2自带日志记录的功能, 可以很方便的记录错误日志和自定义日志</p>
</li>
<li><p>PM2能够启动多个Node进程, 充分利用服务器资源</p>
</li>
</ul>
</li>
</ol>
<h5 id="PM2基本使用"><a href="#PM2基本使用" class="headerlink" title="PM2基本使用"></a>PM2基本使用</h5><p><code>npm install pm2 -g</code></p>
<p><code>pm2 start app.js</code></p>
<h5 id="PM2常用指定"><a href="#PM2常用指定" class="headerlink" title="PM2常用指定"></a>PM2常用指定</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pm2 start app.js|config     <span class="comment">// 启动应用程序</span></span><br><span class="line">pm2 list                    <span class="comment">// 列出启动的所有的应用程序</span></span><br><span class="line">pm2 restart appName|appId   <span class="comment">// 重启应用程序</span></span><br><span class="line">pm2 info appName|appId      <span class="comment">// 查看应用程序详细信息</span></span><br><span class="line">pm2 log appName|appId       <span class="comment">// 显示指定应用程序的日志</span></span><br><span class="line">pm2 monit appName|appId     <span class="comment">// 监控应用程序</span></span><br><span class="line">pm2 stop appName|appId      <span class="comment">// 停止应用程序</span></span><br><span class="line">pm2 <span class="keyword">delete</span> appName|appId    <span class="comment">// 关闭并删除所有应用</span></span><br></pre></td></tr></table></figure>

<h5 id="PM2-进程守护"><a href="#PM2-进程守护" class="headerlink" title="PM2 进程守护"></a>PM2 进程守护</h5><h5 id="PM2常用配置"><a href="#PM2常用配置" class="headerlink" title="PM2常用配置"></a>PM2常用配置</h5><p>pm2.conf.json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"apps"</span>:&#123;</span><br><span class="line">    <span class="attr">"name"</span>:<span class="string">"应用程序名称"</span>,</span><br><span class="line">    <span class="attr">"script"</span>: <span class="string">"入口文件名称"</span>,</span><br><span class="line">    <span class="attr">"watch"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"ignore_watch"</span>: [</span><br><span class="line">      <span class="string">"node_modules"</span>,</span><br><span class="line">      <span class="string">"logs"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">"error_file"</span>: <span class="string">"logs/错误日志文件名称"</span>,</span><br><span class="line">    <span class="attr">"out_file"</span>: <span class="string">"logs/自定义日志文件名称"</span>,</span><br><span class="line">    <span class="attr">"log_date_format"</span>: <span class="string">"yyyy-MM-dd HH:mm:ss"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>pm2 start pm2.conf.json</code></p>
<h5 id="PM2多进程"><a href="#PM2多进程" class="headerlink" title="PM2多进程"></a>PM2多进程</h5><p>在配置文件中增加 instances 配置, 想启动几个Node进程就写几</p>
<p>注意点: 不能超过服务器CPU的核数</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://nini-hub.github.io/2020/12/09/KOA%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="妮妮妮">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/09/KOA%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/" class="post-title-link" itemprop="url">KOA入门学习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">نُشر في</span>

              <time title="أُنشأ: 2020-12-09 16:47:10" itemprop="dateCreated datePublished" datetime="2020-12-09T16:47:10+08:00">2020-12-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">عُدل في</span>
                <time title="عُدل: 2020-12-14 14:07:30" itemprop="dateModified" datetime="2020-12-14T14:07:30+08:00">2020-12-14</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="开篇"><a href="#开篇" class="headerlink" title="开篇"></a>开篇</h4><ol>
<li><p>什么是Express?</p>
<p>Express是第一代最流行的web框架，它对Node.js的http进行了封装</p>
<p>但是它是’基于ES5’的语法，内部实现异步代码，只有一个方法：’回调’</p>
</li>
<li><p>什么是KOA1.x?</p>
<p>随着新版Node.js开始支持ES6，Express的团队又’基于ES6’重新编写了下一代web框架koa。</p>
<p>和Express相比，koa 1.x’使用generator实现异步’.</p>
<p>用generator实现异步比回调简单了不少，但是generator的本意并不是异步</p>
</li>
<li><p>什么是KOA2.x?</p>
<p>koa团队并没有止步于koa 1.x，他们非常超前地’基于ES7’开发了koa2，</p>
<p>和koa 1相比，koa2完全’使用Promise并配合async来实现异步’</p>
</li>
<li><p>Express、Koa1.x、Koa2.x区别</p>
<ul>
<li><p>最大的区别就是内部实现异步的方式不同</p>
<ul>
<li>Express使用回调函数实现异步, 容易出现回调地狱问题, 但是语法更老兼容性更好</li>
<li>Koa1.x使用generator实现异步, 解决了回调地域问题, 但是generator的本意并不是异步</li>
<li>Koa2.x使用Promise并配合async来实现异步, 解决了回调地域问题, 但是语法太新兼容性不好</li>
</ul>
</li>
<li><p>第二大的区别就是重量级不同</p>
<p>Express中内置了很多封装好的功能, 而Koa中将这些功能都封装到了独立的模块中</p>
<p>想要使用这些功能必须先安装对应的模块才能使用, 所以Koa比Express更轻量级</p>
</li>
</ul>
</li>
</ol>
<h4 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h4><ol>
<li><p>如何使用Koa?</p>
<ul>
<li><p>手动安装手动配置</p>
</li>
<li><p>利用Koa脚手架工具安装使用(Koa-generator)</p>
</li>
</ul>
</li>
<li><p>手动安装手动配置  <a href="https://www.npmjs.com/package/koa" target="_blank" rel="noopener">https://www.npmjs.com/package/koa</a></p>
</li>
</ol>
<h5 id="手动安装手动配置"><a href="#手动安装手动配置" class="headerlink" title="手动安装手动配置"></a>手动安装手动配置</h5><ol>
<li><p><code>npm install koa</code></p>
</li>
<li><p>app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.导入Koa</span></span><br><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>);</span><br><span class="line"><span class="comment">// 2.创建服务端实例对象</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa();</span><br><span class="line"></span><br><span class="line"><span class="comment">// response</span></span><br><span class="line">app.use(<span class="function"><span class="params">ctx</span> =&gt;</span> &#123;</span><br><span class="line">    ctx.body = <span class="string">'Hello Koa'</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.指定监听的端口</span></span><br><span class="line">app.listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h5 id="处理静态资源"><a href="#处理静态资源" class="headerlink" title="处理静态资源"></a>处理静态资源</h5><ol>
<li><p>Koa如何处理静态资源?</p>
<p>Koa是一个轻量级的框架, 它将所有的附加功能都封装到了独立的模块中</p>
<p>所以想要使用这些功能, 都必须先安装才能使用</p>
<p><a href="https://www.npmjs.com/package/koa-static" target="_blank" rel="noopener">https://www.npmjs.com/package/koa-static</a></p>
<p><code>npm install koa-static</code></p>
</li>
<li><p>app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>);</span><br><span class="line"><span class="keyword">const</span> serve = <span class="built_in">require</span>(<span class="string">'koa-static'</span>); <span class="comment">// 导入处理静态资源的模块</span></span><br><span class="line"><span class="comment">// 2.创建服务端实例对象</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa();</span><br><span class="line"></span><br><span class="line">app.use(serve(<span class="string">'public'</span>)); <span class="comment">// 注册处理静态资源的中间件</span></span><br><span class="line"><span class="comment">// response</span></span><br><span class="line">app.use(<span class="function"><span class="params">ctx</span> =&gt;</span> &#123;</span><br><span class="line">    ctx.body = <span class="string">'Hello Koa'</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.指定监听的端口</span></span><br><span class="line">app.listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>访问<code>localhost:3000/login.html</code></p>
</li>
</ol>
<h5 id="处理动态网页"><a href="#处理动态网页" class="headerlink" title="处理动态网页"></a>处理动态网页</h5><ol>
<li><p>Koa如何处理动态资源?</p>
<p><a href="https://www.npmjs.com/package/koa-views" target="_blank" rel="noopener">https://www.npmjs.com/package/koa-views</a></p>
<p><code>npm install koa-views</code></p>
</li>
<li><p>app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.导入Koa</span></span><br><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>);</span><br><span class="line"><span class="keyword">const</span> serve = <span class="built_in">require</span>(<span class="string">'koa-static'</span>); <span class="comment">// 导入处理静态资源的模块</span></span><br><span class="line"><span class="keyword">const</span> views = <span class="built_in">require</span>(<span class="string">'koa-views'</span>); <span class="comment">// 导入处理动态资源的模块</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.创建服务端实例对象</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa();</span><br><span class="line"></span><br><span class="line">app.use(serve(<span class="string">'public'</span>)); <span class="comment">// 注册处理静态资源的中间件</span></span><br><span class="line">app.use(views(<span class="string">'views'</span>, &#123;<span class="attr">extension</span>: <span class="string">'ejs'</span>&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// response</span></span><br><span class="line"><span class="comment">// koa中的ctx就是express中的req,res的结合体</span></span><br><span class="line">app.use( <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">    <span class="comment">// ctx.body = 'Hello Koa';</span></span><br><span class="line">    <span class="keyword">await</span> ctx.render(<span class="string">'index'</span>, &#123;<span class="attr">msg</span>: <span class="string">'妮妮碎碎念'</span>&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.指定监听的端口</span></span><br><span class="line">app.listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>访问<code>localhost:3000</code></p>
</li>
</ol>
<h5 id="处理路由"><a href="#处理路由" class="headerlink" title="处理路由"></a>处理路由</h5><ol>
<li><p>Koa如何处理路由?</p>
<p><a href="https://www.npmjs.com/package/koa-router" target="_blank" rel="noopener">https://www.npmjs.com/package/koa-router</a></p>
<p><a href="https://github.com/ZijianHe/koa-router" target="_blank" rel="noopener">https://github.com/ZijianHe/koa-router</a></p>
<p><code>npm install koa-router</code></p>
</li>
<li><p>app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.导入Koa</span></span><br><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>);</span><br><span class="line"><span class="keyword">const</span> serve = <span class="built_in">require</span>(<span class="string">'koa-static'</span>); <span class="comment">// 导入处理静态资源的模块</span></span><br><span class="line"><span class="keyword">const</span> views = <span class="built_in">require</span>(<span class="string">'koa-views'</span>); <span class="comment">// 导入处理动态资源的模块</span></span><br><span class="line"><span class="keyword">const</span> Router = <span class="built_in">require</span>(<span class="string">'koa-router'</span>); <span class="comment">// 导入处理路由的模块</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router(); <span class="comment">// 创建路由对象</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.创建服务端实例对象</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa();</span><br><span class="line"></span><br><span class="line">app.use(serve(<span class="string">'public'</span>)); <span class="comment">// 注册处理静态资源的中间件</span></span><br><span class="line">app.use(views(<span class="string">'views'</span>, &#123;<span class="attr">extension</span>: <span class="string">'ejs'</span>&#125;)); <span class="comment">// 注册处理动态资源的中间件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理路由</span></span><br><span class="line">router.get(<span class="string">'/api/goods/list'</span>, (ctx, next)=&gt;&#123;</span><br><span class="line">    ctx.body = <span class="string">'get /api/goods/list'</span>; <span class="comment">// ctx.body === res.writeHeader + res.end</span></span><br><span class="line">&#125;);</span><br><span class="line">router.get(<span class="string">'/api/user/login'</span>, (ctx, next)=&gt;&#123;</span><br><span class="line">    ctx.body = &#123;</span><br><span class="line">        method: <span class="string">'get'</span>,</span><br><span class="line">        name: <span class="string">'xxn'</span>,</span><br><span class="line">        age: <span class="number">66</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">router.post(<span class="string">'/api/goods/detail'</span>, (ctx, next)=&gt;&#123;</span><br><span class="line">    ctx.body = <span class="string">'post /api/goods/detail'</span>;</span><br><span class="line">&#125;);</span><br><span class="line">router.post(<span class="string">'/api/user/register'</span>, (ctx, next)=&gt;&#123;</span><br><span class="line">    ctx.body = &#123;</span><br><span class="line">        method: <span class="string">'post'</span>,</span><br><span class="line">        name: <span class="string">'666'</span>,</span><br><span class="line">        age: <span class="number">33</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app</span><br><span class="line">    .use(router.routes()) <span class="comment">// 启动路由功能</span></span><br><span class="line">    .use(router.allowedMethods()); <span class="comment">// 自动设置响应头</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.指定监听的端口</span></span><br><span class="line">app.listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>访问<code>localhost:3000</code></p>
</li>
</ol>
<h5 id="处理get请求"><a href="#处理get请求" class="headerlink" title="处理get请求"></a>处理get请求</h5><ol>
<li><p>Koa如何处理Get请求参数?</p>
<ul>
<li><p>处理传统get参数</p>
</li>
<li><p>处理动态路由形式get参数</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.导入Koa</span></span><br><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>);</span><br><span class="line"><span class="keyword">const</span> serve = <span class="built_in">require</span>(<span class="string">'koa-static'</span>); <span class="comment">// 导入处理静态资源的模块</span></span><br><span class="line"><span class="keyword">const</span> views = <span class="built_in">require</span>(<span class="string">'koa-views'</span>); <span class="comment">// 导入处理动态资源的模块</span></span><br><span class="line"><span class="keyword">const</span> Router = <span class="built_in">require</span>(<span class="string">'koa-router'</span>); <span class="comment">// 导入处理路由的模块</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router(); <span class="comment">// 创建路由对象</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.创建服务端实例对象</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa();</span><br><span class="line"></span><br><span class="line">router.get(<span class="string">'/user'</span>, (ctx, next)=&gt;&#123;</span><br><span class="line">    <span class="keyword">let</span> request = ctx.request;</span><br><span class="line">    <span class="built_in">console</span>.log(request.query); <span class="comment">// 获取转换成对象之后的get请求参数</span></span><br><span class="line">    <span class="built_in">console</span>.log(request.querystring); <span class="comment">// 获取字符串形式的get请求参数</span></span><br><span class="line">&#125;);</span><br><span class="line">router.get(<span class="string">'/login/:name/:age'</span>, (ctx, next)=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(ctx.params);</span><br><span class="line">&#125;);</span><br><span class="line">app.use(serve(<span class="string">'public'</span>)); <span class="comment">// 注册处理静态资源的中间件</span></span><br><span class="line">app.use(views(<span class="string">'views'</span>, &#123;<span class="attr">extension</span>: <span class="string">'ejs'</span>&#125;)); <span class="comment">// 注册处理动态资源的中间件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理路由</span></span><br><span class="line"></span><br><span class="line">app</span><br><span class="line">    .use(router.routes()) <span class="comment">// 启动路由功能</span></span><br><span class="line">    .use(router.allowedMethods()); <span class="comment">// 自动设置响应头</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.指定监听的端口</span></span><br><span class="line">app.listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h5 id="处理post请求"><a href="#处理post请求" class="headerlink" title="处理post请求"></a>处理post请求</h5><ol>
<li><p>Koa如何处理Post请求参数?</p>
<ul>
<li><p>借助koa-bodyparser中间件</p>
</li>
<li><p>koa-bodyparser中间件会将post请求参数转换成对象之后放到请求对象的body中</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.导入Koa</span></span><br><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>);</span><br><span class="line"><span class="keyword">const</span> serve = <span class="built_in">require</span>(<span class="string">'koa-static'</span>); <span class="comment">// 导入处理静态资源的模块</span></span><br><span class="line"><span class="keyword">const</span> views = <span class="built_in">require</span>(<span class="string">'koa-views'</span>); <span class="comment">// 导入处理动态资源的模块</span></span><br><span class="line"><span class="keyword">const</span> Router = <span class="built_in">require</span>(<span class="string">'koa-router'</span>); <span class="comment">// 导入处理路由的模块</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router(); <span class="comment">// 创建路由对象</span></span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">'koa-bodyparser'</span>); <span class="comment">// 导入处理post请求参数的模块</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.创建服务端实例对象</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa();</span><br><span class="line"></span><br><span class="line">app.use(serve(<span class="string">'public'</span>)); <span class="comment">// 注册处理静态资源的中间件</span></span><br><span class="line">app.use(views(<span class="string">'views'</span>, &#123;<span class="attr">extension</span>: <span class="string">'ejs'</span>&#125;)); <span class="comment">// 注册处理动态资源的中间件</span></span><br><span class="line"></span><br><span class="line">app.use(bodyParser()); <span class="comment">// 注册处理post请求参数的中间件</span></span><br><span class="line"><span class="comment">// 处理路由</span></span><br><span class="line">router.post(<span class="string">'/user'</span>, (ctx, next)=&gt;&#123;</span><br><span class="line">    <span class="keyword">let</span> request = ctx.request;</span><br><span class="line">    <span class="built_in">console</span>.log(request.body);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app</span><br><span class="line">    .use(router.routes()) <span class="comment">// 启动路由功能</span></span><br><span class="line">    .use(router.allowedMethods()); <span class="comment">// 自动设置响应头</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.指定监听的端口</span></span><br><span class="line">app.listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h5 id="处理cookie"><a href="#处理cookie" class="headerlink" title="处理cookie"></a>处理cookie</h5><ol>
<li><p>Koa如何处理cookie?</p>
<p>Koa中处理cookie不需要引入其他模块, 只要拿到ctx对象就可以操作cookie</p>
<p><a href="https://demopark.github.io/koa-docs-Zh-CN/" target="_blank" rel="noopener">https://demopark.github.io/koa-docs-Zh-CN/</a></p>
<p><a href="https://demopark.github.io/koa-docs-Zh-CN/api/context.html" target="_blank" rel="noopener">https://demopark.github.io/koa-docs-Zh-CN/api/context.html</a></p>
<p><em>注意点：如何在koa中存储值为中文的cookie</em></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">// 1.导入Koa</span></span><br><span class="line">   <span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>);</span><br><span class="line">   <span class="keyword">const</span> serve = <span class="built_in">require</span>(<span class="string">'koa-static'</span>); <span class="comment">// 导入处理静态资源的模块</span></span><br><span class="line">   <span class="keyword">const</span> views = <span class="built_in">require</span>(<span class="string">'koa-views'</span>); <span class="comment">// 导入处理动态资源的模块</span></span><br><span class="line">   <span class="keyword">const</span> Router = <span class="built_in">require</span>(<span class="string">'koa-router'</span>); <span class="comment">// 导入处理路由的模块</span></span><br><span class="line">   <span class="keyword">const</span> router = <span class="keyword">new</span> Router(); <span class="comment">// 创建路由对象</span></span><br><span class="line">   <span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">'koa-bodyparser'</span>); <span class="comment">// 导入处理post请求参数的模块</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment">// 2.创建服务端实例对象</span></span><br><span class="line">   <span class="keyword">const</span> app = <span class="keyword">new</span> Koa();</span><br><span class="line">   </span><br><span class="line">   app.use(serve(<span class="string">'public'</span>)); <span class="comment">// 注册处理静态资源的中间件</span></span><br><span class="line">   app.use(views(<span class="string">'views'</span>, &#123;<span class="attr">extension</span>: <span class="string">'ejs'</span>&#125;)); <span class="comment">// 注册处理动态资源的中间件</span></span><br><span class="line">   app.use(bodyParser()); <span class="comment">// 注册处理post请求参数的中间件</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment">// 处理路由</span></span><br><span class="line">   router.get(<span class="string">'/setCookie'</span>, (ctx, next)=&gt;&#123;</span><br><span class="line">       <span class="comment">// ctx.cookies.set('name', 'nini', &#123;</span></span><br><span class="line">       <span class="comment">//     path: '/',</span></span><br><span class="line">       <span class="comment">//     httpOnly: true,</span></span><br><span class="line">       <span class="comment">//     maxAge: 24 * 60 * 60 * 1000</span></span><br><span class="line">       <span class="comment">// &#125;);</span></span><br><span class="line">       <span class="comment">// 注意点: 在koa中不能给cookie设置中文的值</span></span><br><span class="line">       <span class="keyword">let</span> value = <span class="keyword">new</span> Buffer(<span class="string">'妮妮'</span>).toString(<span class="string">'base64'</span>);</span><br><span class="line">       ctx.cookies.set(<span class="string">'userName'</span>, value, &#123;</span><br><span class="line">           path: <span class="string">'/'</span>,</span><br><span class="line">           httpOnly: <span class="literal">true</span>,</span><br><span class="line">           maxAge: <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span></span><br><span class="line">       &#125;);</span><br><span class="line">       <span class="comment">// let value = new Buffer('妮妮').toString('base64');</span></span><br><span class="line">       <span class="comment">// console.log(value); // 5p2O5Y2X5rGf</span></span><br><span class="line">       <span class="comment">// let res = new Buffer('5p2O5Y2X5rGf', 'base64').toString();</span></span><br><span class="line">       <span class="comment">// console.log(res);</span></span><br><span class="line">   &#125;);</span><br><span class="line">   router.get(<span class="string">'/getCookie'</span>, (ctx, next)=&gt;&#123;</span><br><span class="line">       <span class="comment">// console.log(ctx.cookies.get('name'));</span></span><br><span class="line">       <span class="keyword">let</span> value = ctx.cookies.get(<span class="string">'userName'</span>);</span><br><span class="line">       <span class="keyword">let</span> res = <span class="keyword">new</span> Buffer(value, <span class="string">'base64'</span>).toString();</span><br><span class="line">       <span class="built_in">console</span>.log(res);</span><br><span class="line">   &#125;);</span><br><span class="line">   app</span><br><span class="line">       .use(router.routes()) <span class="comment">// 启动路由功能</span></span><br><span class="line">       .use(router.allowedMethods()); <span class="comment">// 自动设置响应头</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment">// 3.指定监听的端口</span></span><br><span class="line">app.listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h5 id="处理错误"><a href="#处理错误" class="headerlink" title="处理错误"></a>处理错误</h5><ol>
<li><p>Koa如何处理错误?</p>
<p>使用koa-onerror模块</p>
<p><a href="https://www.npmjs.com/package/koa-onerror" target="_blank" rel="noopener">https://www.npmjs.com/package/koa-onerror</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.导入Koa</span></span><br><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>);</span><br><span class="line"><span class="keyword">const</span> serve = <span class="built_in">require</span>(<span class="string">'koa-static'</span>); <span class="comment">// 导入处理静态资源的模块</span></span><br><span class="line"><span class="keyword">const</span> views = <span class="built_in">require</span>(<span class="string">'koa-views'</span>); <span class="comment">// 导入处理动态资源的模块</span></span><br><span class="line"><span class="keyword">const</span> Router = <span class="built_in">require</span>(<span class="string">'koa-router'</span>); <span class="comment">// 导入处理路由的模块</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router(); <span class="comment">// 创建路由对象</span></span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">'koa-bodyparser'</span>); <span class="comment">// 导入处理post请求参数的模块</span></span><br><span class="line"><span class="keyword">const</span> onerror = <span class="built_in">require</span>(<span class="string">'koa-onerror'</span>); <span class="comment">// 导入处理错误的模块</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.创建服务端实例对象</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa();</span><br><span class="line">onerror(app); <span class="comment">// 告诉koa-onerror我们需要捕获所有服务端实例对象的错误</span></span><br><span class="line"></span><br><span class="line">app.use(serve(<span class="string">'public'</span>)); <span class="comment">// 注册处理静态资源的中间件</span></span><br><span class="line">app.use(views(<span class="string">'views'</span>, &#123;<span class="attr">extension</span>: <span class="string">'ejs'</span>&#125;)); <span class="comment">// 注册处理动态资源的中间件</span></span><br><span class="line">app.use(bodyParser()); <span class="comment">// 注册处理post请求参数的中间件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理路由</span></span><br><span class="line">router.get(<span class="string">'/api/user/login'</span>, (ctx, next)=&gt;&#123;</span><br><span class="line">    ctx.body = <span class="string">'我是登录'</span>;</span><br><span class="line">&#125;);</span><br><span class="line">router.get(<span class="string">'/api/user/register'</span>, (ctx, next)=&gt;&#123;</span><br><span class="line">    ctx.body = <span class="string">'我是注册'</span>;</span><br><span class="line">&#125;);</span><br><span class="line">app</span><br><span class="line">    .use(router.routes()) <span class="comment">// 启动路由功能</span></span><br><span class="line">    .use(router.allowedMethods()); <span class="comment">// 自动设置响应头</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理错误</span></span><br><span class="line">app.use(<span class="function">(<span class="params">err, ctx</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err.status, err.message);</span><br><span class="line">    ctx.body = err.message;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.指定监听的端口</span></span><br><span class="line">app.listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>撒花撒花~~</p>
<h5 id="使用脚手架"><a href="#使用脚手架" class="headerlink" title="使用脚手架"></a>使用脚手架</h5><ol>
<li><p>全局安装koa-generator</p>
<ul>
<li><p><code>npm install -g koa-generator</code></p>
</li>
<li><p>quickly start</p>
<p><code>koa demo &amp;&amp; cd demo</code></p>
<p><code>koa2 demo &amp;&amp; cd demo</code></p>
</li>
</ul>
</li>
<li><p>与express-generator不同的是，通过koa-generator生成项目里已经使用了nodemon，无序额外安装及设置</p>
</li>
<li><p>目录结构介绍-参照express</p>
<p>app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>) <span class="comment">// 导入koa</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa() <span class="comment">// 创建服务端实例对象</span></span><br><span class="line"><span class="keyword">const</span> views = <span class="built_in">require</span>(<span class="string">'koa-views'</span>) <span class="comment">// 导入了处理动态资源包</span></span><br><span class="line"><span class="keyword">const</span> json = <span class="built_in">require</span>(<span class="string">'koa-json'</span>) <span class="comment">// 导入了输出json格式的包</span></span><br><span class="line"><span class="keyword">const</span> onerror = <span class="built_in">require</span>(<span class="string">'koa-onerror'</span>) <span class="comment">// 导入了处理错误的包</span></span><br><span class="line"><span class="keyword">const</span> bodyparser = <span class="built_in">require</span>(<span class="string">'koa-bodyparser'</span>) <span class="comment">// 导入了处理post请求参数包</span></span><br><span class="line"><span class="keyword">const</span> logger = <span class="built_in">require</span>(<span class="string">'koa-logger'</span>) <span class="comment">// 导入了记录日志包</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> index = <span class="built_in">require</span>(<span class="string">'./routes/index'</span>) <span class="comment">// 导入了封装好的路由</span></span><br><span class="line"><span class="keyword">const</span> users = <span class="built_in">require</span>(<span class="string">'./routes/users'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// error handler</span></span><br><span class="line">onerror(app) <span class="comment">// 告诉系统需要捕获哪一个程序的错误</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册了解析post请求参数的中间件</span></span><br><span class="line">app.use(bodyparser(&#123;</span><br><span class="line">  enableTypes:[<span class="string">'json'</span>, <span class="string">'form'</span>, <span class="string">'text'</span>]</span><br><span class="line">&#125;))</span><br><span class="line">app.use(json())</span><br><span class="line"><span class="comment">// 注册了记录日志的中间件</span></span><br><span class="line">app.use(logger())</span><br><span class="line"><span class="comment">// 注册了处理静态资源的中间件</span></span><br><span class="line">app.use(<span class="built_in">require</span>(<span class="string">'koa-static'</span>)(__dirname + <span class="string">'/public'</span>))</span><br><span class="line"><span class="comment">// 注册了处理动态资源的中间件</span></span><br><span class="line">app.use(views(__dirname + <span class="string">'/views'</span>, &#123;</span><br><span class="line">  extension: <span class="string">'pug'</span></span><br><span class="line">&#125;))</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 记录日志</span></span><br><span class="line">app.use(<span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> start = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">  <span class="keyword">await</span> next()</span><br><span class="line">  <span class="keyword">const</span> ms = <span class="keyword">new</span> <span class="built_in">Date</span>() - start</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;ctx.method&#125;</span> <span class="subst">$&#123;ctx.url&#125;</span> - <span class="subst">$&#123;ms&#125;</span>ms`</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册启用了路由</span></span><br><span class="line">app.use(index.routes(), index.allowedMethods())</span><br><span class="line">app.use(users.routes(), users.allowedMethods())</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理错误</span></span><br><span class="line">app.on(<span class="string">'error'</span>, (err, ctx) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.error(<span class="string">'server error'</span>, err, ctx)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = app</span><br></pre></td></tr></table></figure>

</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://nini-hub.github.io/2020/12/09/webpack%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="妮妮妮">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/09/webpack%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">webpack基础配置</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">نُشر في</span>
              

              <time title="أُنشأ: 2020-12-09 16:16:43 / عُدل: 16:17:50" itemprop="dateCreated datePublished" datetime="2020-12-09T16:16:43+08:00">2020-12-09</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ol>
<li><p>sourcemap存储映射关系</p>
<ul>
<li><strong>development</strong>： cheap-module-eval-source-map</li>
</ul>
<p>只需要行错误信息, 并且包含第三方模块错误信息, 并且不会生成单独sourcemap文件</p>
<ul>
<li><strong>production</strong>: cheap-module-source-map</li>
</ul>
<p>只需要行错误信息, 并且包含第三方模块错误信息, 并且会生成单独sourcemap文件</p>
</li>
<li><p>module: 告诉webpack如何处理webpack不能够识别的文件</p>
<ul>
<li><p>打包图片规则:url-loader</p>
<p>优势:(相比于file-loader)</p>
<ul>
<li>图片比较小的时候直接转换成base64字符串图片, 减少请求次数</li>
<li>图片比较大的时候由于生成的base64字符串图片也比较大, 就保持原有的图片</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.(png|jpg|gif)$/</span>,</span><br><span class="line">    use: [</span><br><span class="line">        &#123;</span><br><span class="line">            loader: <span class="string">'url-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">                <span class="comment">// 指定图片限制的大小</span></span><br><span class="line">                limit: <span class="number">1024</span> * <span class="number">100</span>,</span><br><span class="line">                <span class="comment">// 指定打包后文件名称</span></span><br><span class="line">                name: <span class="string">'[name].[ext]'</span>,</span><br><span class="line">                <span class="comment">// 指定打包后文件存放目录</span></span><br><span class="line">                outputPath: <span class="string">'images/'</span>,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>



</li>
</ol>
<ul>
<li>配置less-loader</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">  use: [&#123;</span><br><span class="line">      loader: <span class="string">"style-loader"</span> <span class="comment">// 将 JS 字符串生成为 style 节点</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">      loader: <span class="string">"css-loader"</span> ,<span class="comment">// 将 CSS 转化成 CommonJS 模块</span></span><br><span class="line">       options: &#123;</span><br><span class="line">        modules: <span class="literal">true</span> <span class="comment">// 开启CSS模块化</span></span><br><span class="line">       &#125;</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">      loader: <span class="string">"less-loader"</span> <span class="comment">// 将 less 编译成 CSS</span></span><br><span class="line">  &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​            <em>use:自下而上，自右向左</em></p>
<ol start="3">
<li><p>plugins: 告诉webpack需要新增一些什么样的功能</p>
<ul>
<li>HtmlWebpackPlugin</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">plugins: [<span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">    <span class="comment">// 指定打包的模板, 如果不指定会自动生成一个空的</span></span><br><span class="line">    template: <span class="string">"./index.html"</span>,</span><br><span class="line">    minify: &#123;</span><br><span class="line">        <span class="comment">// 告诉htmlplugin打包之后的html文件需要压缩</span></span><br><span class="line">        collapseWhitespace: <span class="literal">true</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)]</span><br></pre></td></tr></table></figure>
</li>
<li><p>webpack-watch</p>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">watch: <span class="literal">true</span>,</span><br><span class="line">watchOptions: &#123;</span><br><span class="line">    aggregateTimeout: <span class="number">300</span>, <span class="comment">// 防抖, 和函数防抖一样, 改变过程中不重新打包, 只有改变完成指定时间后才打包</span></span><br><span class="line">    poll: <span class="number">1000</span>, <span class="comment">// 每隔多少时间检查一次变动</span></span><br><span class="line">    ignored: <span class="regexp">/node_modules/</span> <span class="comment">// 排除一些巨大的文件夹, 不需要监控的文件夹</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">optimization: 配置webpack的优化项</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line">optimization: &#123;</span><br><span class="line">    minimizer: [<span class="keyword">new</span> TerserJSPlugin(&#123;&#125;), <span class="keyword">new</span> OptimizeCSSAssetsPlugin(&#123;&#125;)],</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>devServer:自动检测文件变化配置</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line">    contentBase: <span class="string">"./bundle"</span>, <span class="comment">// 打包后的目录</span></span><br><span class="line">    open: <span class="literal">true</span>, <span class="comment">// 是否自动在浏览器中打开</span></span><br><span class="line">    port: <span class="number">9090</span> <span class="comment">// 服务器端口号</span></span><br><span class="line">    proxy: [&#123;</span><br><span class="line">        context: [<span class="string">"/user"</span>, <span class="string">"/login"</span>],</span><br><span class="line">        target: <span class="string">"http://127.0.0.1:3000"</span>,</span><br><span class="line">        changeOrigin: <span class="literal">true</span>,     <span class="comment">// 域名跨域</span></span><br><span class="line">        secure: <span class="literal">false</span>,          <span class="comment">// https跨域</span></span><br><span class="line">        pathRewrite:&#123;<span class="string">""</span>: <span class="string">"/api"</span>&#125; <span class="comment">// 路径重写, 将路径中的api替换为空</span></span><br><span class="line">    &#125;],</span><br><span class="line">    hot: <span class="literal">true</span>, <span class="comment">// 开启热更新, 只要开启了热更新就不会自动刷新网页了</span></span><br><span class="line">    hotOnly: <span class="literal">true</span> <span class="comment">// 哪怕不支持热更新也不要刷新网页</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://nini-hub.github.io/2020/12/09/TypeScript%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="妮妮妮">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/09/TypeScript%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">TypeScript入门笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">نُشر في</span>
              

              <time title="أُنشأ: 2020-12-09 16:16:18 / عُدل: 16:19:48" itemprop="dateCreated datePublished" datetime="2020-12-09T16:16:18+08:00">2020-12-09</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ol>
<li>修改webpack配置文件</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">entry: <span class="string">"./src/js/index.ts"</span>,</span><br><span class="line">resolve: &#123;</span><br><span class="line">	extensions: [ <span class="string">'.tsx'</span>, <span class="string">'.ts'</span>, <span class="string">'.js'</span> ]</span><br><span class="line">  	&#125;,</span><br><span class="line">   <span class="built_in">module</span>: &#123;</span><br><span class="line">       rules: [</span><br><span class="line">           <span class="comment">// ts编译配置</span></span><br><span class="line">           &#123;</span><br><span class="line">               test: <span class="regexp">/\.tsx?$/</span>,</span><br><span class="line">               use: <span class="string">'ts-loader'</span>,</span><br><span class="line">               exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">           &#125;</span><br><span class="line">       ]</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure>

<h5 id="基本类型"><a href="#基本类型" class="headerlink" title="基本类型"></a>基本类型</h5><h6 id="数组和元祖"><a href="#数组和元祖" class="headerlink" title="数组和元祖"></a>数组和元祖</h6><ul>
<li><p>数组</p>
<ul>
<li><code>let arr1:Array&lt;number&gt;</code>:表示定义了一个名称叫做arr1的数组, 这个数组中将来只能够存储数值类型的数据</li>
<li><code>let arr2:string[]</code>:只能够存储字符串类型的数据</li>
<li><code>let arr3:(number | string)[]</code>:既可以存储数值类型的数据, 也可以存储字符串类型的数据</li>
<li><code>let arr4:any[]</code>:任意类型</li>
</ul>
</li>
<li><p>元组：定长定类型</p>
<ul>
<li><code>let arr5:[string, number, boolean]</code> : 表示定义了一个名称叫做arr5的元祖, 这个元祖中将来可以（只能）存储3个元素, 第一个元素必须是字符串类型, 第二个元素必须是数字类型, 第三个元素必须是布尔类型</li>
</ul>
</li>
</ul>
<h6 id="枚举类型：表示固定的几个取值"><a href="#枚举类型：表示固定的几个取值" class="headerlink" title="枚举类型：表示固定的几个取值"></a>枚举类型：表示固定的几个取值</h6><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义了一个名称叫做Gender的枚举类型, 这个枚举类型的取值有两个, 分别是Male和Femal</span></span><br><span class="line"><span class="keyword">enum</span> Gender&#123; </span><br><span class="line">  Male,</span><br><span class="line">  Femal</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 定义了一个名称叫做val的变量, 这个变量中只能保存Male或者Femal</span></span><br><span class="line"><span class="keyword">let</span> val:Gender; </span><br><span class="line">val = Gender.Male;</span><br><span class="line">val = Gender.Femal;</span><br><span class="line">val = <span class="string">'nini'</span>; <span class="comment">// 报错</span></span><br><span class="line">val = <span class="literal">false</span>;<span class="comment">// 报错</span></span><br><span class="line">val = <span class="number">666</span>; <span class="comment">// 不会报错</span></span><br><span class="line"><span class="comment">// TS中的枚举底层实现的本质其实就是数值类型, 所以赋值一个数值不会报错</span></span><br><span class="line"><span class="built_in">console</span>.log(Gender.Male); <span class="comment">// 0</span></span><br><span class="line"><span class="built_in">console</span>.log(Gender.Femal);<span class="comment">// 1</span></span><br><span class="line"><span class="built_in">console</span>.log(Gender[<span class="number">0</span>]);<span class="comment">// Male</span></span><br><span class="line"><span class="built_in">console</span>.log(Gender[<span class="number">1</span>]);<span class="comment">// Femal</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 探究底层实现原理</span></span><br><span class="line"><span class="keyword">var</span> Gender;</span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">Gender</span>) </span>&#123;</span><br><span class="line"> <span class="comment">// Gender[key] = value;</span></span><br><span class="line">  Gender[Gender[<span class="string">"Male"</span>] = <span class="number">0</span>] = <span class="string">"Male"</span>;</span><br><span class="line">  Gender[Gender[<span class="string">"Femal"</span>] = <span class="number">1</span>] = <span class="string">"Femal"</span>;</span><br><span class="line">&#125;)(Gender || (Gender = &#123;&#125;));</span><br><span class="line"><span class="comment">// Gender["Male"] = 0  返回 0</span></span><br><span class="line"><span class="keyword">let</span> Gender = &#123;&#125;;</span><br><span class="line">Gender[<span class="string">"Male"</span>] = <span class="number">0</span>;</span><br><span class="line">Gender[<span class="number">0</span>] = <span class="string">"Male"</span>;</span><br><span class="line">Gender[<span class="string">"Femal"</span>] = <span class="number">1</span>;</span><br><span class="line">Gender[<span class="number">1</span>] = <span class="string">"Femal"</span>;</span><br></pre></td></tr></table></figure>

<h6 id="any和void"><a href="#any和void" class="headerlink" title="any和void"></a>any和void</h6><ul>
<li>any表示任意类型，一般用于定义一些通用性比较强的变量, 或者用于保存从其它框架中获取的不确定类型的值</li>
<li>void与any正好相反, 表示没有任何类型, 一般用于函数返回值，在TS中只有null和undefined可以赋值给void类型</li>
</ul>
<h6 id="Never和Object类型"><a href="#Never和Object类型" class="headerlink" title="Never和Object类型"></a>Never和Object类型</h6><ul>
<li><p>Never：表示的是那些永不存在的值的类型</p>
<p>一般用于抛出异常或根本不可能有返回值的函数</p>
</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">demo</span>(<span class="params"></span>):<span class="title">never</span> </span>&#123;</span><br><span class="line">   <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'报错了'</span>);</span><br><span class="line">&#125;</span><br><span class="line">demo();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">demo2</span>(<span class="params"></span>):<span class="title">never</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">demo2();</span><br></pre></td></tr></table></figure>

<ul>
<li>Object:对象</li>
</ul>
<p><code>let obj:object</code></p>
<h6 id="类型断言"><a href="#类型断言" class="headerlink" title="类型断言"></a>类型断言</h6><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> str1:<span class="built_in">any</span> = <span class="string">'nini'</span>;</span><br><span class="line"><span class="comment">// 方式一</span></span><br><span class="line"> <span class="keyword">let</span> len = (&lt;<span class="built_in">string</span>&gt;str1).length;</span><br><span class="line"><span class="comment">// 方式二</span></span><br><span class="line"><span class="comment">// 注意点: 在企业开发中推荐使用as来进行类型转换(类型断言)</span></span><br><span class="line"><span class="comment">//         因为第一种方式有兼容性问题, 在使用到了JSX的时候兼容性不是很好</span></span><br><span class="line"><span class="keyword">let</span> len = (str1 <span class="keyword">as</span> <span class="built_in">string</span>).length;</span><br><span class="line"><span class="built_in">console</span>.log(len);</span><br></pre></td></tr></table></figure>

<h5 id="接口类型"><a href="#接口类型" class="headerlink" title="接口类型"></a>接口类型</h5><ul>
<li>基本使用</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> FullName&#123;</span><br><span class="line">    firstName:<span class="built_in">string</span></span><br><span class="line">    lastName:<span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    firstName:<span class="string">'Jonathan'</span>,</span><br><span class="line">    lastName:<span class="string">'Lee'</span></span><br><span class="line">    <span class="comment">// lastName:18</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 需求: 要求定义一个函数输出一个人完整的姓名, 这个人的姓必须是字符串, 这个人的名也必须是一个字符</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">say</span>(<span class="params">&#123;firstName, lastName&#125;:FullName</span>):<span class="title">void</span> </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`我的姓名是:<span class="subst">$&#123;firstName&#125;</span>_<span class="subst">$&#123;lastName&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line">say(obj);</span><br></pre></td></tr></table></figure>

<ul>
<li><p>可选属性和索引签名</p>
<p><em>如果使用接口来限定了变量或者形参, 那么在给变量或者形参赋值的时候,赋予的值就必须和接口限定的一模一样才可以, 多一个或者少一个都不行</em>    </p>
<ul>
<li>少一个或少多个怎么做? –&gt;可选属性</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> FullName&#123;</span><br><span class="line">    firstName:<span class="built_in">string</span></span><br><span class="line">    lastName:<span class="built_in">string</span></span><br><span class="line">    middleName?:<span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>多一个或者多多个怎么做? 如果绕开TS检查</p>
<ul>
<li><p>方式一: 使用类型断言(告诉ts憋管我)</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">say(&#123;firstName:<span class="string">'Jonathan'</span>, lastName:<span class="string">'Lee'</span>, middleName:<span class="string">"666"</span>, abc:<span class="string">'abc'</span>&#125; <span class="keyword">as</span> FullName);</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式二: 使用变量（不推荐）</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">（<span class="keyword">let</span> obj = &#123;firstName:<span class="string">'Jonathan'</span>, lastName:<span class="string">'Lee'</span>, middleName:<span class="string">"666"</span>, abc:<span class="string">'abc'</span>&#125;;</span><br><span class="line">say(obj);</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式三: 使用索引签名</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> FullName&#123;</span><br><span class="line">    firstName:<span class="built_in">string</span></span><br><span class="line">    lastName:<span class="built_in">string</span></span><br><span class="line">    middleName?:<span class="built_in">string</span></span><br><span class="line">    [propName:<span class="built_in">string</span>]:<span class="built_in">any</span></span><br><span class="line">&#125;</span><br><span class="line">say(&#123;firstName:<span class="string">'Jonathan'</span>, lastName:<span class="string">'Lee'</span>, middleName:<span class="string">"666"</span>, abc:<span class="string">'abc'</span>, <span class="number">123</span>:<span class="number">123</span>, def:<span class="string">"def"</span>&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>索引签名</strong>：索引签名用于描述那些“通过索引得到”的类型，比如arr[10]或obj[“key”]</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> FullName &#123;</span><br><span class="line">    [propName:<span class="built_in">string</span>]:<span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> obj:FullName = &#123;</span><br><span class="line">    <span class="comment">// 注意点: 只要key和value满足索引签名的限定即可, 无论有多少个都无所谓</span></span><br><span class="line">    firstName:<span class="string">'Jonathan'</span>,</span><br><span class="line">    lastName:<span class="string">'Lee'</span>,</span><br><span class="line">    <span class="comment">// middleName:false // 报错</span></span><br><span class="line">    <span class="comment">// false: '666' // 无论key是什么类型最终都会自动转换成字符串类型, 所以没有报错</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>函数接口和混合类型接口</p>
<ul>
<li>函数接口</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> SumInterface &#123;</span><br><span class="line">    (a:<span class="built_in">number</span>, b:<span class="built_in">number</span>):<span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> sum:SumInterface = <span class="function"><span class="keyword">function</span> (<span class="params">x:<span class="built_in">number</span>, y:<span class="built_in">number</span></span>):<span class="title">number</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> res = sum(<span class="number">10</span>, <span class="number">20</span>);</span><br><span class="line"><span class="built_in">console</span>.log(res);</span><br></pre></td></tr></table></figure>

<ul>
<li>混合类型接口：约定的内容中既有对象属性, 又有函数</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> CountInterface &#123;</span><br><span class="line">    ():<span class="built_in">void</span></span><br><span class="line">    count:<span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> getCounter = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>):<span class="title">CountInterface</span> </span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    CountInterface接口要求数据既要是一个没有参数没有返回值的函数</span></span><br><span class="line"><span class="comment">                              又要是一个拥有count属性的对象</span></span><br><span class="line"><span class="comment">    fn作为函数的时候符合接口中函数接口的限定 ():void</span></span><br><span class="line"><span class="comment">    fn作为对象的时候符合接口中对象属性的限定  count:number</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="keyword">let</span> fn = &lt;CountInterface&gt;<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        fn.count++;</span><br><span class="line">        <span class="built_in">console</span>.log(fn.count);</span><br><span class="line">    &#125;</span><br><span class="line">    fn.count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> fn;</span><br><span class="line">&#125;)();</span><br><span class="line">getCounter();</span><br><span class="line">getCounter();</span><br><span class="line">getCounter();</span><br></pre></td></tr></table></figure>
</li>
<li><p>接口的继承</p>
</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> LengthInterface &#123;</span><br><span class="line">    length:<span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> WidthInterface &#123;</span><br><span class="line">    width:<span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> HeightInterface &#123;</span><br><span class="line">    height:<span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> RectInterface <span class="keyword">extends</span> LengthInterface,WidthInterface,HeightInterface &#123;</span><br><span class="line">    <span class="comment">// length:number</span></span><br><span class="line">    <span class="comment">// width:number</span></span><br><span class="line">    <span class="comment">// height:number</span></span><br><span class="line">    color:<span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> rect:RectInterface = &#123;</span><br><span class="line">    length:<span class="number">10</span>,</span><br><span class="line">    width:<span class="number">20</span>,</span><br><span class="line">    height:<span class="number">30</span>,</span><br><span class="line">    color:<span class="string">'red'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h5><h6 id="函数重载：同名的函数可以根据不同的参数实现不同的功能"><a href="#函数重载：同名的函数可以根据不同的参数实现不同的功能" class="headerlink" title="函数重载：同名的函数可以根据不同的参数实现不同的功能"></a>函数重载：同名的函数可以根据不同的参数实现不同的功能</h6><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getArray</span>(<span class="params">x:<span class="built_in">number</span></span>):<span class="title">number</span>[]</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getArray</span>(<span class="params">str:<span class="built_in">string</span></span>):<span class="title">string</span>[]</span>;</span><br><span class="line"><span class="comment">// 实现函数的重载</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getArray</span>(<span class="params">value:<span class="built_in">any</span></span>):<span class="title">any</span>[] </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> value === <span class="string">'string'</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> value.split(<span class="string">''</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> arr = [];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt;= value; i++)&#123;</span><br><span class="line">            arr.push(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> arr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h5><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> getArray = &lt;T&gt;(value:T, items:<span class="built_in">number</span> = <span class="number">5</span>):T[]=&gt;&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Array</span>(items).fill(value);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// let arr = getArray&lt;string&gt;('abc');</span></span><br><span class="line"><span class="comment">// let arr = getArray&lt;number&gt;(6);</span></span><br><span class="line"><span class="comment">// 注意点: 泛型具体的类型可以不指定</span></span><br><span class="line"><span class="comment">//         如果没有指定, 那么就会根据我们传递的泛型参数自动推导出来</span></span><br><span class="line"><span class="keyword">let</span> arr = getArray(<span class="string">'abc'</span>);</span><br><span class="line"><span class="comment">// let arr = getArray(6);</span></span><br><span class="line"><span class="keyword">let</span> res = arr.map(<span class="function"><span class="params">item</span>=&gt;</span>item.length);</span><br><span class="line"><span class="built_in">console</span>.log(res);</span><br></pre></td></tr></table></figure>

<h6 id="泛型约束"><a href="#泛型约束" class="headerlink" title="泛型约束"></a>泛型约束</h6><p>默认情况下我们可以指定泛型为任意类型</p>
<p>但是有些情况下我们需要指定的类型满足某些条件后才能指定</p>
<p>那么这个时候我们就可以使用泛型约束</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 需求: 要求指定的泛型类型必须有Length属性才可以</span></span><br><span class="line"><span class="keyword">interface</span> LengthInterface&#123;</span><br><span class="line">    length:<span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> getArray = &lt;T <span class="keyword">extends</span> LengthInterface&gt;(value:T, items:<span class="built_in">number</span> = <span class="number">5</span>):T[]=&gt;&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Array</span>(items).fill(value);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> arr = getArray&lt;<span class="built_in">string</span>&gt;(<span class="string">'abc'</span>);</span><br><span class="line"><span class="comment">// let arr = getArray&lt;number&gt;(6);</span></span><br><span class="line"><span class="keyword">let</span> res = arr.map(<span class="function"><span class="params">item</span>=&gt;</span>item.length);</span><br></pre></td></tr></table></figure>



<h6 id="在泛型约束中使用类型参数"><a href="#在泛型约束中使用类型参数" class="headerlink" title="在泛型约束中使用类型参数"></a>在泛型约束中使用类型参数</h6><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> getProps = (obj:object,key:<span class="built_in">string</span>):<span class="function"><span class="params">any</span>=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> obj[key]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  a:<span class="string">'a'</span>,</span><br><span class="line">  b:<span class="string">'b'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(getProps(obj,<span class="string">'c'</span>));</span><br><span class="line"><span class="comment">// 代码不够健壮, 明明obj中没有c这个key但是却没有报错</span></span><br><span class="line"><span class="comment">// let res = getProps(obj, "c");</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> getProps = &lt;t,k <span class="keyword">extends</span> keyof t&gt;(obj:t,key:k):<span class="function"><span class="params">any</span>=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> obj[key]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  a:<span class="string">'a'</span>,</span><br><span class="line">  b:<span class="string">'b'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(getProps(obj,<span class="string">'c'</span>));<span class="comment">// 报错</span></span><br></pre></td></tr></table></figure>

<h5 id="类"><a href="#类" class="headerlink" title="类"></a>类</h5><h6 id="类属性修饰符"><a href="#类属性修饰符" class="headerlink" title="类属性修饰符"></a>类属性修饰符</h6><ul>
<li><p>public(公开的)   :</p>
<p>如果使用public来修饰属性, 那么表示这个属性是公开的</p>
<p>可以在类的内部使用, 也可以在子类中使用, 也可以在外部使用</p>
</li>
<li><p>protected(受保护的) :</p>
<p>如果使用protected来修饰属性, 那么表示这个属性是受保护的</p>
<p>可以在类的内部使用, 也可以在子类中使用</p>
</li>
<li><p>private(私有的)   :</p>
<p>如果使用private来修饰属性, 那么表示这个属性是私有的</p>
<p>可以在类的内部使用</p>
</li>
<li><p>readonly(只读的)  :</p>
</li>
</ul>
<h6 id="类方法修饰符"><a href="#类方法修饰符" class="headerlink" title="类方法修饰符"></a>类方法修饰符</h6><ul>
<li><p>public :</p>
<p>如果使用public来修饰方法, 那么表示这个方法是公开的</p>
<p>可以在类的内部使用, 也可以在子类中使用, 也可以在外部使用</p>
</li>
<li><p>protected :</p>
<p>如果使用protected来修饰方法, 那么表示这个方法是受保护的</p>
<p>可以在类的内部使用, 也可以在子类中使用</p>
</li>
<li><p>private</p>
<p>如果使用private来修饰方法, 那么表示这个方法是私有的</p>
<p>可以在类的内部使用</p>
</li>
</ul>
<h6 id="可选属性和参数属性"><a href="#可选属性和参数属性" class="headerlink" title="可选属性和参数属性"></a>可选属性和参数属性</h6><ul>
<li><p>可选属性：和接口中的可选属性一样, 可传可不传的属性</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Person &#123;</span><br><span class="line">  <span class="comment">// 注意点: 在TS中如果定义了实例属性, 那么就必须在构造函数中使用, 否则就会报错</span></span><br><span class="line">  name:<span class="built_in">string</span>;</span><br><span class="line">  age?:<span class="built_in">number</span>; <span class="comment">// 可选属性</span></span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params">name:<span class="built_in">string</span>, age?:<span class="built_in">number</span></span>)&#123;</span><br><span class="line">      <span class="keyword">this</span>.name = name;</span><br><span class="line">      <span class="keyword">this</span>.age = age;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// setNameAndAge(name:string, age:number)&#123;</span></span><br><span class="line">  <span class="comment">//   this.name = name;</span></span><br><span class="line">  <span class="comment">//   this.age = age;</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> Person(<span class="string">'xxn'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(p);</span><br></pre></td></tr></table></figure>
</li>
<li><p>参数属性: 一句话搞定实例属性的接收和定义</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Person &#123;</span><br><span class="line">  name:<span class="built_in">string</span>;</span><br><span class="line">  age:<span class="built_in">number</span>;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params">name:<span class="built_in">string</span>, age?:<span class="built_in">number</span></span>)&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> Person &#123;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">public</span> name:<span class="built_in">string</span>,<span class="keyword">public</span> age:<span class="built_in">number</span></span>)&#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> Person(<span class="string">'xxn'</span>, <span class="number">18</span>);</span><br><span class="line"><span class="built_in">console</span>.log(p);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h6 id="存取器"><a href="#存取器" class="headerlink" title="存取器"></a>存取器</h6><p>通过getters/setters来截取对对象成员的访问</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Person &#123;</span><br><span class="line">    <span class="keyword">private</span> _age:<span class="built_in">number</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">set</span> age(val:<span class="built_in">number</span>)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'进入了set age方法'</span>);</span><br><span class="line">        <span class="keyword">if</span>(val&lt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'人的年龄不能小于零'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>._age = val;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">get</span> age():<span class="built_in">number</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'进入了get age方法'</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>._age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> Person();</span><br><span class="line">p.age = <span class="number">18</span>;</span><br><span class="line"><span class="comment">// p.age = -6; // p.age(-6);</span></span><br><span class="line"><span class="built_in">console</span>.log(p.age);</span><br></pre></td></tr></table></figure>

<h6 id="抽象类"><a href="#抽象类" class="headerlink" title="抽象类"></a>抽象类</h6><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义基类  不被外界创建</span></span><br><span class="line"><span class="keyword">class</span> Person &#123;</span><br><span class="line">    name:<span class="built_in">string</span>;</span><br><span class="line">    age: <span class="built_in">number</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">constructor</span>(<span class="params">name:<span class="built_in">string</span>, age:<span class="built_in">number</span></span>)&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> Student <span class="keyword">extends</span> Person&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">name:<span class="built_in">string</span>, age:<span class="built_in">number</span></span>)&#123;</span><br><span class="line">        <span class="keyword">super</span>(name, age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// let p = new Person('xxn', 18); //报错</span></span><br><span class="line"><span class="keyword">let</span> stu = <span class="keyword">new</span> Student(<span class="string">'xxn'</span>, <span class="number">18</span>);</span><br><span class="line"><span class="built_in">console</span>.log(stu);</span><br></pre></td></tr></table></figure>

<p>抽象类：专门用于定义哪些不希望被外界直接创建的类的</p>
<p>抽象类一般用于定义基类</p>
<p>抽象类和接口一样用于约束子类</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> Person &#123;</span><br><span class="line">    <span class="keyword">abstract</span> name:<span class="built_in">string</span>;</span><br><span class="line">    <span class="keyword">abstract</span> say():<span class="built_in">void</span>;</span><br><span class="line">    <span class="comment">// 子类必须有name 必须有say()</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// let p = new Person(); // 报错</span></span><br><span class="line"><span class="keyword">class</span> Student <span class="keyword">extends</span> Person&#123;</span><br><span class="line">    name:<span class="built_in">string</span> = <span class="string">'xxn'</span>;</span><br><span class="line">    say():<span class="built_in">void</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`我的名字是<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> stu = <span class="keyword">new</span> Student();</span><br><span class="line">stu.say();</span><br></pre></td></tr></table></figure>

<p><em>抽象类和接口区别?</em></p>
<ul>
<li><p>接口中只能定义约束, 不能定义具体实现</p>
</li>
<li><p>而抽象类中既可以定义约束, 又可以定义具体实现</p>
</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> Person &#123;</span><br><span class="line">    <span class="keyword">abstract</span> name:<span class="built_in">string</span>;</span><br><span class="line">    <span class="keyword">abstract</span> say():<span class="built_in">void</span>;</span><br><span class="line">    <span class="comment">// 子类必须有name 必须有say()</span></span><br><span class="line">    eat():<span class="built_in">void</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>正在吃东西`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// let p = new Person();</span></span><br><span class="line"><span class="keyword">class</span> Student <span class="keyword">extends</span> Person&#123;</span><br><span class="line">    name:<span class="built_in">string</span> = <span class="string">'xxn'</span>;</span><br><span class="line">    say():<span class="built_in">void</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`我的名字是<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> stu = <span class="keyword">new</span> Student();</span><br><span class="line">stu.say();</span><br><span class="line">stu.eat();</span><br></pre></td></tr></table></figure>

<h6 id="类”实现”接口"><a href="#类”实现”接口" class="headerlink" title="类”实现”接口"></a>类”实现”接口</h6><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> PersonInterface &#123;</span><br><span class="line">    name:<span class="built_in">string</span>;</span><br><span class="line">    say():<span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 只要实现的某一个接口, 那么就必须实现接口中所有的属性和方法</span></span><br><span class="line"><span class="keyword">class</span> Person <span class="keyword">implements</span> PersonInterface&#123;</span><br><span class="line">    name:<span class="built_in">string</span> = <span class="string">'xxn'</span>;</span><br><span class="line">    say():<span class="built_in">void</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`我的名字叫:<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> Person();</span><br><span class="line">p.say();</span><br></pre></td></tr></table></figure>

<h6 id="接口”继承”类"><a href="#接口”继承”类" class="headerlink" title="接口”继承”类"></a>接口”继承”类</h6><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Person &#123;</span><br><span class="line">    <span class="comment">// protected name:string = 'xxn';</span></span><br><span class="line">    name:<span class="built_in">string</span> = <span class="string">'xxn'</span>;</span><br><span class="line">    age:<span class="built_in">number</span> = <span class="number">18</span>;</span><br><span class="line">    <span class="keyword">protected</span> say():<span class="built_in">void</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`name = <span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>, age = <span class="subst">$&#123;<span class="keyword">this</span>.age&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// let p = new Person();</span></span><br><span class="line"><span class="comment">// p.say();</span></span><br><span class="line"><span class="comment">// 注意点: 只要一个接口继承了某个类, 那么就会继承这个类中所有的属性和方法</span></span><br><span class="line"><span class="comment">//         但是只会继承属性和方法的声明, 不会继承属性和方法实现</span></span><br><span class="line"><span class="comment">// 注意点: 如果接口继承的类中包含了protected的属性和方法, 那么就只有这个类的子类才能实现这个接口</span></span><br><span class="line"><span class="keyword">interface</span> PersonInterface <span class="keyword">extends</span> Person&#123;</span><br><span class="line">    gender:<span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> Student <span class="keyword">extends</span> Person <span class="keyword">implements</span> PersonInterface&#123;</span><br><span class="line">    gender:<span class="built_in">string</span> = <span class="string">'male'</span>;</span><br><span class="line">    name:<span class="built_in">string</span> = <span class="string">'xxn'</span>;</span><br><span class="line">    age:<span class="built_in">number</span> = <span class="number">18</span>;</span><br><span class="line">    say():<span class="built_in">void</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`name = <span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>, age = <span class="subst">$&#123;<span class="keyword">this</span>.age&#125;</span>, gender = <span class="subst">$&#123;<span class="keyword">this</span>.gender&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> stu = <span class="keyword">new</span> Student();</span><br><span class="line">stu.say();</span><br></pre></td></tr></table></figure>

<h6 id="类和泛型"><a href="#类和泛型" class="headerlink" title="类和泛型"></a>类和泛型</h6><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Chache&lt;T&gt; &#123;</span><br><span class="line">    arr:T[] = [];</span><br><span class="line">    add(value:T):T&#123;</span><br><span class="line">        <span class="keyword">this</span>.arr.push(value);</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">    all():T[]&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.arr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> chache = <span class="keyword">new</span> Chache&lt;<span class="built_in">number</span>&gt;();</span><br><span class="line">chache.add(<span class="number">1</span>);</span><br><span class="line">chache.add(<span class="number">3</span>);</span><br><span class="line">chache.add(<span class="number">5</span>);</span><br><span class="line"><span class="built_in">console</span>.log(chache.all());</span><br></pre></td></tr></table></figure>

<h6 id="接口合并现象"><a href="#接口合并现象" class="headerlink" title="接口合并现象:"></a>接口合并现象:</h6><p>当我们定义了多个同名的接口时, 多个接口的内容会自动合并</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> TestInterface &#123;</span><br><span class="line">    name:<span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> TestInterface &#123;</span><br><span class="line">    age:<span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">interface TestInterface &#123;</span></span><br><span class="line"><span class="comment">    name:string;</span></span><br><span class="line"><span class="comment">    age:number;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Person <span class="keyword">implements</span> TestInterface&#123;</span><br><span class="line">    age:<span class="built_in">number</span> = <span class="number">19</span>;</span><br><span class="line">    name:<span class="built_in">string</span> = <span class="string">'nini'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h5><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 默认情况下就是数字枚举</span></span><br><span class="line"><span class="keyword">enum</span> Gender&#123;</span><br><span class="line">    Male,</span><br><span class="line">    Female</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>枚举反向映射:</strong></p>
<ul>
<li><p>可以根据枚举值获取到原始值</p>
</li>
<li><p>也可以根据原始值获取到枚举值</p>
</li>
</ul>
<ol>
<li><p>数字枚举</p>
<ul>
<li>数字枚举的取值默认从0开始递增</li>
<li>数字枚举的取值可以是字面量, 也可以是常量, 也可以是计算的结果</li>
</ul>
</li>
</ol>
<ol start="2">
<li>字符串枚举</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> Gender&#123;</span><br><span class="line">    Male = <span class="string">'www.baidu.com'</span>,</span><br><span class="line">    Female = <span class="string">'www.sina.com'</span> <span class="comment">// 注意点: 如果使用字符串给前面的枚举值赋值了, 那么后面的枚举值也必须手动赋值</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(Gender.Male);</span><br><span class="line"><span class="built_in">console</span>.log(Gender.Female);</span><br></pre></td></tr></table></figure>

<p>注意点: </p>
<ul>
<li><p>如果使用字符串给前面的枚举值赋值了, 那么后面的枚举值也必须手动赋值</p>
</li>
<li><p>和数字枚举不一样, 字符串枚举不能使用常量或者计算结果给枚举值赋值</p>
</li>
<li><p>虽然字符串枚举不能够使用常量或者计算结果给枚举值赋值, 但是它可以使用内部的其它枚举值来赋值</p>
</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> str = <span class="string">'nini'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getStr</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'abc'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">enum</span> Gender&#123;</span><br><span class="line">    Male = <span class="string">'www.baidu.com'</span>,</span><br><span class="line">    <span class="comment">// Male = str, 报错</span></span><br><span class="line">    <span class="comment">// Male = getStr(),  报错</span></span><br><span class="line">    Female = <span class="string">'www.sina.com'</span>,</span><br><span class="line">    Yao = Female</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(Gender.Female);</span><br><span class="line"><span class="built_in">console</span>.log(Gender.Yao);</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>异构枚举</li>
</ol>
<p>枚举中既包含数字又包含字符串, 我们就称之为异构枚举</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> Gender&#123;</span><br><span class="line">    Male = <span class="number">6</span>,</span><br><span class="line">    Female = <span class="string">'nv'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(Gender.Male);</span><br><span class="line"><span class="built_in">console</span>.log(Gender.Female);</span><br><span class="line"><span class="built_in">console</span>.log(Gender[<span class="number">6</span>]);</span><br><span class="line"><span class="comment">// 注意点: 如果是字符串枚举, 那么无法通过原始值获取到枚举值</span></span><br><span class="line"><span class="comment">// console.log(Gender['nv']);</span></span><br><span class="line"><span class="built_in">console</span>.log(Gender);</span><br></pre></td></tr></table></figure>

<h6 id="枚举成员类型"><a href="#枚举成员类型" class="headerlink" title="枚举成员类型"></a>枚举成员类型</h6><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> Gender&#123;</span><br><span class="line">    Male,</span><br><span class="line">    Female</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> TestInterface &#123;</span><br><span class="line">    age: Gender.Male</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> Person <span class="keyword">implements</span> TestInterface&#123;</span><br><span class="line">    age: Gender.Male</span><br><span class="line">    <span class="comment">// age: Gender.Female // 由于类型不匹配, 所以会报错</span></span><br><span class="line">    <span class="comment">// age: 0 // 注意点: 由于数字枚举的本质就是数值, 所以这里写一个数值也不会报错</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> Gender&#123;</span><br><span class="line">    Male = <span class="string">'www.baidu.com'</span>,</span><br><span class="line">    Female = <span class="string">'www.sina.com'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> TestInterface &#123;</span><br><span class="line">    age: Gender.Male</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> Person <span class="keyword">implements</span> TestInterface&#123;</span><br><span class="line">     age: Gender.Male</span><br><span class="line">    <span class="comment">// age: Gender.Female 报错</span></span><br><span class="line">    <span class="comment">// age: 'www.baidu.com' // 注意点: 如果是字符串枚举, 那么只能是枚举成员的值, 不能是其它的值 报错</span></span><br><span class="line">    <span class="comment">// age: string 报错</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行时枚举</p>
<ul>
<li><p>枚举在编译之后是一个真实存储的对象, 所以可以在运行时使用</p>
</li>
<li><p>而像接口这种只是用来做约束做静态检查的代码, 编译之后是不存在的</p>
</li>
</ul>
<p>常量枚举</p>
<ul>
<li><p>普通枚举会生成真实存在的对象</p>
</li>
<li><p>常量枚举不会生成真实存在的对象, 而是利用枚举成员的值直接替换使用到的地方</p>
</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> Gender1&#123;</span><br><span class="line">    Male,</span><br><span class="line">    Female</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(Gender1.Male === <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">enum</span> Gender2&#123;</span><br><span class="line">    Male,</span><br><span class="line">    Female</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(Gender2.Male === <span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p><strong>类型兼容性，函数兼容性，枚举兼容性，类兼容性，泛型兼容性：不想做笔记</strong></p>
<h5 id="交叉和联合类型"><a href="#交叉和联合类型" class="headerlink" title="交叉和联合类型"></a>交叉和联合类型</h5><ol>
<li><p>交叉类型</p>
<p>格式: type1 &amp; type2 &amp; …</p>
<p>交叉类型是将多个类型合并为一个类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> mergeFn = &lt;T, U&gt;<span class="function">(<span class="params">arg1:T, arg2:U</span>):(<span class="params">T &amp; U</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> res = &#123;&#125; <span class="keyword">as</span> (T &amp; U);</span><br><span class="line">    res = <span class="built_in">Object</span>.assign(arg1, arg2);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> res = mergeFn(&#123;name:<span class="string">'nini'</span>&#125;, &#123;age:<span class="number">18</span>&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(res);</span><br></pre></td></tr></table></figure>
</li>
<li><p>联合类型</p>
<p>格式: type1 | type2 | …</p>
<p>联合类型是多个类型中的任意一个类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> value: (<span class="built_in">string</span> | <span class="built_in">number</span>);</span><br><span class="line">value = <span class="string">'abc'</span>;</span><br><span class="line">value = <span class="number">123</span>;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>对于联合类型的变量，在使用时如何确切告诉编译器它是哪一种类型：<strong>通过类型断言或者类型保护</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> getRandomValue = <span class="function"><span class="params">()</span>:(<span class="params"><span class="built_in">string</span> | <span class="built_in">number</span></span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> num = <span class="built_in">Math</span>.random();</span><br><span class="line">    <span class="keyword">return</span> (num &gt;= <span class="number">0.5</span>) ? <span class="string">'abc'</span> : <span class="number">123.123</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>虽然通过类型断言可以确切的告诉编译器当前的变量是什么类型,</p>
<p>但是每一次使用的时候都需要手动的告诉编译器, 这样比较麻烦, 冗余代码也比较多</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>((value <span class="keyword">as</span> <span class="built_in">string</span>).length)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log((value <span class="keyword">as</span> <span class="built_in">string</span>).length);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log((value <span class="keyword">as</span> <span class="built_in">number</span>).toFixed());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p>定义了一个类型保护函数, 这个函数的’返回类型’是一个布尔类型,这个函数的返回值类型是, 传入的参数 + is 具体类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isString</span>(<span class="params">value:(<span class="built_in">string</span> | <span class="built_in">number</span>)</span>): <span class="title">value</span> <span class="title">is</span> <span class="title">string</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">'string'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(isString(value))&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value.length);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value.toFixed());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>除了可以通过typeof类实现类型保护以外, 我们还可以通过instanceof来实现类型保护</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Person &#123;</span><br><span class="line">    name:<span class="built_in">string</span> = <span class="string">'nini'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> Animal &#123;</span><br><span class="line">    age: <span class="built_in">number</span> = <span class="number">18</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> getRandomObject = <span class="function"><span class="params">()</span>:(<span class="params">Person | Animal</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> num = <span class="built_in">Math</span>.random();</span><br><span class="line">    <span class="keyword">return</span> (num &gt;= <span class="number">0.5</span>) ? <span class="keyword">new</span> Person() : <span class="keyword">new</span> Animal();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> obj = getRandomObject();</span><br><span class="line"><span class="built_in">console</span>.log(obj);</span><br><span class="line"><span class="keyword">if</span>(obj <span class="keyword">instanceof</span> Person)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(obj.name);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(obj.age);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="null和undefined"><a href="#null和undefined" class="headerlink" title="null和undefined"></a>null和undefined</h6><ul>
<li><p>默认情况下我们可以将 null和 undefined赋值给任意类型</p>
</li>
<li><p>默认情况下null和 undefined也可以相互赋值</p>
</li>
</ul>
<p><em>注意点: 在企业开发中, 如果不想把 null和 undefined赋值给其它的类型或者不想让 null和 undefined相互赋值, 那么我们就可以开strictNullChecks</em></p>
<ul>
<li><p>如果我们开启了strictNullChecks, 还想把null和 undefined赋值给其它的类型， 那么我们就必须在声明的时候使用联合类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> value:(<span class="built_in">number</span> | <span class="literal">null</span> | <span class="literal">undefined</span>);</span><br><span class="line">value = <span class="literal">null</span>;</span><br><span class="line">value = <span class="literal">undefined</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>对于可选属性和可选参数而言, 如果开启了strictNullChecks, 那么默认情况下数据类型就是联合类型</p>
<p>就是当前的类型 + undefined类型</p>
</li>
<li><p>去除 null或 undefined检测</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getLength</span>(<span class="params">value:(<span class="built_in">string</span> | <span class="literal">null</span> | <span class="literal">undefined</span>)</span>) </span>&#123;</span><br><span class="line">    value = <span class="string">'abc'</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">// return value.length; // 报错</span></span><br><span class="line">        <span class="comment">// return (value || '').length;</span></span><br><span class="line">        <span class="comment">// return (value as string).length;</span></span><br><span class="line">        <span class="comment">// 我们可以使用!来去除null和undefined</span></span><br><span class="line">        <span class="comment">// !的含义就是这个变量一定不是null和undefined</span></span><br><span class="line">        <span class="keyword">return</span> value!.length;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> fn = getLength(<span class="string">'www.it66.com'</span>);</span><br><span class="line"><span class="keyword">let</span> res = fn();</span><br><span class="line"><span class="built_in">console</span>.log(res);</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h5 id="兼容性"><a href="#兼容性" class="headerlink" title="兼容性"></a>兼容性</h5><h6 id="类型兼容性"><a href="#类型兼容性" class="headerlink" title="类型兼容性"></a>类型兼容性</h6><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> TestInterface &#123;</span><br><span class="line">    name:<span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p1 = &#123;name:<span class="string">'nini'</span>&#125;;</span><br><span class="line"><span class="keyword">let</span> p2 = &#123;age:<span class="number">18</span>&#125;;</span><br><span class="line"><span class="keyword">let</span> p3 = &#123;name:<span class="string">'nini'</span>, age:<span class="number">18</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> t:TestInterface;</span><br><span class="line">t = p1;</span><br><span class="line">t = p2; <span class="comment">// 报错</span></span><br><span class="line">t = p3; <span class="comment">// 可多不可少</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> TestInterface &#123;</span><br><span class="line">    name:<span class="built_in">string</span>;</span><br><span class="line">    children:&#123;</span><br><span class="line">        age:<span class="built_in">number</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p1 = &#123;name:<span class="string">'nini'</span>, children:&#123;age:<span class="number">18</span>&#125;&#125;;</span><br><span class="line"><span class="keyword">let</span> p2 = &#123;name:<span class="string">'nini'</span>,children:&#123;age:<span class="string">'abc'</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> t:TestInterface;</span><br><span class="line">t = p1;</span><br><span class="line">t = p2; <span class="comment">// 报错 会递归检查</span></span><br></pre></td></tr></table></figure>

<h6 id="函数兼容性"><a href="#函数兼容性" class="headerlink" title="函数兼容性"></a>函数兼容性</h6><ol>
<li><p>参数个数</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fn1 = <span class="function">(<span class="params">x:<span class="built_in">number</span>, y:<span class="built_in">number</span></span>)=&gt;</span>&#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> fn2 = <span class="function">(<span class="params">x:<span class="built_in">number</span></span>)=&gt;</span>&#123;&#125;;</span><br><span class="line">fn1 = fn2;</span><br><span class="line">fn2 = fn1; <span class="comment">//报错 可少不可多</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>参数类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fn1 = <span class="function">(<span class="params">x:<span class="built_in">number</span></span>)=&gt;</span>&#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> fn2 = <span class="function">(<span class="params">x:<span class="built_in">number</span></span>)=&gt;</span>&#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> fn3 = <span class="function">(<span class="params">x:<span class="built_in">string</span></span>)=&gt;</span>&#123;&#125;;</span><br><span class="line">fn1 = fn2;</span><br><span class="line">fn2 = fn1;</span><br><span class="line">fn1 = fn3; <span class="comment">// 报错 必须一模一样</span></span><br><span class="line">fn3 = fn1;<span class="comment">// 报错</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>返回值类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fn1 = ():<span class="function"><span class="params">number</span>=&gt;</span> <span class="number">123</span>;</span><br><span class="line"><span class="keyword">let</span> fn2 = ():<span class="function"><span class="params">number</span>=&gt;</span> <span class="number">456</span>;</span><br><span class="line"><span class="keyword">let</span> fn3 = ():<span class="function"><span class="params">string</span>=&gt;</span> <span class="string">'abc'</span>;</span><br><span class="line">fn1 = fn2;</span><br><span class="line">fn2 = fn1;</span><br><span class="line">fn1 = fn3; <span class="comment">// 报错必须一模一样</span></span><br><span class="line">fn3 = fn1;<span class="comment">// 报错必须一模一样</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>函数双向协变</p>
<ul>
<li><p>参数的双向协变</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fn1 = <span class="function">(<span class="params">x:(<span class="params"><span class="built_in">number</span> | <span class="built_in">string</span></span>)</span>) =&gt;</span>&#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> fn2 = <span class="function">(<span class="params">x:<span class="built_in">number</span></span>) =&gt;</span>&#123;&#125;;</span><br><span class="line">fn1 = fn2;</span><br><span class="line">fn2 = fn1;</span><br></pre></td></tr></table></figure>
</li>
<li><p>返回值的双向协变</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fn1 = <span class="function">(<span class="params">x:<span class="built_in">boolean</span></span>):(<span class="params"><span class="built_in">number</span> | <span class="built_in">string</span></span>) =&gt;</span> x ? <span class="number">123</span> : <span class="string">'abc'</span>;</span><br><span class="line"><span class="keyword">let</span> fn2 = (x:<span class="built_in">boolean</span>):<span class="function"><span class="params">number</span> =&gt;</span> <span class="number">456</span>;</span><br><span class="line">fn1 = fn2; <span class="comment">// 不报错 但是可以将返回值是具体类型的赋值给联合类型的</span></span><br><span class="line">fn2 = fn1; <span class="comment">//报错  不能将返回值是联合类型的赋值给具体类型的</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>函数重载</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x:<span class="built_in">number</span>, y:<span class="built_in">number</span></span>):<span class="title">number</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x:<span class="built_in">string</span>, y:<span class="built_in">string</span></span>):<span class="title">string</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sub</span>(<span class="params">x:<span class="built_in">number</span>, y:<span class="built_in">number</span></span>):<span class="title">number</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sub</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x - y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// let fn = add;</span></span><br><span class="line"><span class="comment">// fn = sub; // 报错 不能将重载少的赋值给重载多的</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> fn = sub;</span><br><span class="line">fn = add; <span class="comment">// 可以将重载多的赋值给重载少</span></span><br></pre></td></tr></table></figure>


</li>
</ol>
<h6 id="枚举兼容性"><a href="#枚举兼容性" class="headerlink" title="枚举兼容性"></a>枚举兼容性</h6><ul>
<li><p>数字枚举与数值兼容</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> Gender&#123;</span><br><span class="line">    Male,</span><br><span class="line">    Female</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> value:Gender;</span><br><span class="line">value = Gender.Male;</span><br><span class="line">value = <span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>数字枚举与数字枚举不兼容</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> Gender&#123;</span><br><span class="line">    Male, <span class="comment">// 0</span></span><br><span class="line">    Female <span class="comment">// 1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">enum</span> Animal&#123;</span><br><span class="line">    Dog, <span class="comment">// 0</span></span><br><span class="line">    Cat <span class="comment">// 1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> value:Gender;</span><br><span class="line">value = Gender.Male;</span><br><span class="line">value = Animal.Dog; <span class="comment">// 报错</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>字符串枚举与字符串不兼容</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> Gender&#123;</span><br><span class="line">    Male = <span class="string">'abc'</span>,</span><br><span class="line">    Female  = <span class="string">'def'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> value:Gender;</span><br><span class="line">value = Gender.Male;</span><br><span class="line">value = <span class="string">'abc'</span>;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h6 id="类兼容性"><a href="#类兼容性" class="headerlink" title="类兼容性"></a>类兼容性</h6><ul>
<li>只比较实例成员, 不比较类的构造函数和静态成员</li>
<li>类的私有属性和受保护属性会影响兼容性</li>
</ul>
<h6 id="泛型兼容性"><a href="#泛型兼容性" class="headerlink" title="泛型兼容性"></a>泛型兼容性</h6><p>泛型只影响使用的部分, 不会影响声明的部分</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> TestInterface&lt;T&gt; &#123;</span><br><span class="line">    <span class="comment">// age:T;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> t1: TestInterface&lt;<span class="built_in">number</span>&gt;; <span class="comment">// age:number</span></span><br><span class="line"><span class="keyword">let</span> t2: TestInterface&lt;<span class="built_in">string</span>&gt;; <span class="comment">// age:string</span></span><br><span class="line">t1 = t2;</span><br><span class="line">t2 = t1;</span><br></pre></td></tr></table></figure>

<h5 id="类型别名和接口的异同点"><a href="#类型别名和接口的异同点" class="headerlink" title="类型别名和接口的异同点"></a>类型别名和接口的异同点</h5><ol>
<li><p>都可以描述属性或方法</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> MyType = &#123;</span><br><span class="line">    name:<span class="built_in">string</span>;</span><br><span class="line">    say():<span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> MyInterface &#123;</span><br><span class="line">    name:<span class="built_in">string</span>;</span><br><span class="line">    say():<span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>都允许拓展</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> MyInterface &#123;</span><br><span class="line">    name:<span class="built_in">string</span>;</span><br><span class="line">    say():<span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> MyInterface2 <span class="keyword">extends</span> MyInterface&#123;</span><br><span class="line">    age:<span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> value:MyInterface2 = &#123;</span><br><span class="line">    name:<span class="string">'nini'</span>,</span><br><span class="line">    age:<span class="number">18</span>,</span><br><span class="line">    say():<span class="built_in">void</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MyType = &#123;</span><br><span class="line">    name:<span class="built_in">string</span>;</span><br><span class="line">    say():<span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> MyType2 = MyType &amp; &#123;</span><br><span class="line">    age:<span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> value:MyType2 = &#123;</span><br><span class="line">    name:<span class="string">'nini'</span>,</span><br><span class="line">    age: <span class="number">18</span>,</span><br><span class="line">    say():<span class="built_in">void</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>type 可以声明基本类型别名，联合类型，元组等类型, interface不能</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> MyType1 = <span class="built_in">boolean</span>;</span><br><span class="line"><span class="keyword">type</span> MyType2 = <span class="built_in">string</span> | <span class="built_in">number</span>;</span><br><span class="line"><span class="keyword">type</span> MyType3 = [<span class="built_in">string</span>, <span class="built_in">boolean</span>, <span class="built_in">number</span>];</span><br></pre></td></tr></table></figure>
</li>
<li><p>type不会自动合并</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> MyInterface &#123;</span><br><span class="line">    name:<span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> MyInterface &#123;</span><br><span class="line">    age:<span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> value:MyInterface  =&#123;</span><br><span class="line">    name:<span class="string">'nini'</span>,</span><br><span class="line">    age:<span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MyType = &#123;</span><br><span class="line">    name:<span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> MyType = &#123;</span><br><span class="line">    age:<span class="built_in">number</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="可辨识联合"><a href="#可辨识联合" class="headerlink" title="可辨识联合"></a>可辨识联合</h5><ol>
<li>什么是可辨识联合<br>具有共同的可辨识特征。<br>一个类型别名, 包含了具有共同的可辨识特征的类型的联合。</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> Square &#123;</span><br><span class="line">    kind: <span class="string">"square"</span>; <span class="comment">// 共同的可辨识特征</span></span><br><span class="line">    size: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> Rectangle &#123;</span><br><span class="line">    kind: <span class="string">"rectangle"</span>; <span class="comment">// 共同的可辨识特征</span></span><br><span class="line">    width: <span class="built_in">number</span>;</span><br><span class="line">    height: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> Circle &#123;</span><br><span class="line">    kind: <span class="string">"circle"</span>; <span class="comment">// 共同的可辨识特征</span></span><br><span class="line">    radius: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Shape就是一个可辨识联合</span></span><br><span class="line"><span class="comment">因为: 它的取值是一个联合</span></span><br><span class="line"><span class="comment">因为: 这个联合的每一个取值都有一个共同的可辨识特征</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="keyword">type</span> Shape = (Square | Rectangle | Circle);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">aera</span>(<span class="params">s: Shape</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (s.kind) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"square"</span>: <span class="keyword">return</span> s.size * s.size;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"rectangle"</span>: <span class="keyword">return</span> s.width * s.height;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"circle"</span>: <span class="keyword">return</span>  <span class="built_in">Math</span>.PI * s.radius ** <span class="number">2</span>; <span class="comment">// **是ES7中推出的幂运算符</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在企业开发中如果相对可辨识联合的完整性进行检查, 那么我们可以使用</p>
<ul>
<li><p>方式一: 给函数添加返回值 + 开启strictNullChecks</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">aera</span>(<span class="params">s: Shape</span>):<span class="title">number</span></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (s.kind) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"square"</span>: <span class="keyword">return</span> s.size * s.size;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"rectangle"</span>: <span class="keyword">return</span> s.width * s.height;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"circle"</span>: <span class="keyword">return</span>  <span class="built_in">Math</span>.PI * s.radius ** <span class="number">2</span>; <span class="comment">// **是ES7中推出的幂运算符</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ol>
<ul>
<li><p>方式二: 添加default + never(不常用)</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyNever</span>(<span class="params">x: never</span>):<span class="title">never</span> </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'可辨识联合处理不完整'</span> + x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">aera</span>(<span class="params">s: Shape</span>):<span class="title">number</span></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (s.kind) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"square"</span>: <span class="keyword">return</span> s.size * s.size;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"rectangle"</span>: <span class="keyword">return</span> s.width * s.height;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"circle"</span>: <span class="keyword">return</span>  <span class="built_in">Math</span>.PI * s.radius ** <span class="number">2</span>; <span class="comment">// **是ES7中推出的幂运算符</span></span><br><span class="line">        <span class="keyword">default</span>:<span class="keyword">return</span> MyNever(s)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="索引类型"><a href="#索引类型" class="headerlink" title="索引类型"></a>索引类型</h5><p>通过[]索引类型访问操作符, 我们就能得到某个索引的类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Person &#123;</span><br><span class="line">    name:<span class="built_in">string</span>;</span><br><span class="line">    age:<span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> MyType = Person[<span class="string">'name'</span>];</span><br></pre></td></tr></table></figure>

<ul>
<li><p>应用场景</p>
<p>需求: 获取指定对象, 部分属性的值, 放到数组中返回</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    name:<span class="string">'nini'</span>,</span><br><span class="line">    age:<span class="number">18</span>,</span><br><span class="line">    gender:<span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getValues</span>&lt;<span class="title">T</span>, <span class="title">K</span> <span class="title">extends</span> <span class="title">keyof</span> <span class="title">T</span>&gt;(<span class="params">obj:T, keys:K[]</span>):<span class="title">T</span>[<span class="title">K</span>][] </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> arr = [] <span class="keyword">as</span> T[K][];</span><br><span class="line">    keys.forEach(<span class="function"><span class="params">key</span>=&gt;</span>&#123;</span><br><span class="line">        arr.push(obj[key]);</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> res = getValues(obj, [<span class="string">'name'</span>, <span class="string">'age'</span>]);</span><br><span class="line"><span class="built_in">console</span>.log(res);</span><br></pre></td></tr></table></figure>

<p><em>索引访问操作符注意点,不会返回null/undefined/never类型</em></p>
</li>
</ul>
<h4 id="组件性能优化"><a href="#组件性能优化" class="headerlink" title="组件性能优化"></a>组件性能优化</h4><ul>
<li><p>类组件</p>
<p><code>extend PureComponent</code></p>
</li>
<li><p>函数组件</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> son = React.memo(</span><br><span class="line">	<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    	<span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>哈哈哈<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h5 id="映射类型"><a href="#映射类型" class="headerlink" title="映射类型?"></a>映射类型?</h5><p>根据旧的类型创建出新的类型, 我们称之为映射类型</p>
<ul>
<li><p>只读/可选</p>
<p>通过+/-来指定添加还是删除 只读和可选修饰符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">interface TestInterface1&#123;</span><br><span class="line">    name:string;</span><br><span class="line">    age:number</span><br><span class="line">&#125;</span><br><span class="line">interface TestInterface2&#123;</span><br><span class="line">    readonly name?:string;</span><br><span class="line">    readonly age?:number</span><br><span class="line">&#125;	</span><br><span class="line">type ReadonlyTestInterface&lt;T&gt; &#x3D; &#123;</span><br><span class="line">    &#x2F;&#x2F; [P in keyof T]作用: 遍历出指定类型所有的key, 添加到当前对象上</span><br><span class="line">    &#x2F;&#x2F; readonly [P in keyof T]: T[P]</span><br><span class="line">    &#x2F;&#x2F; readonly [P in keyof T]?: T[P]</span><br><span class="line">    -readonly [P in keyof T]-?: T[P]</span><br><span class="line">&#125;</span><br><span class="line">type MyType &#x3D; ReadonlyTestInterface&lt;TestInterface2&gt;</span><br></pre></td></tr></table></figure>

<p><strong>由于生成只读属性和可选属性比较常用</strong>, 所以TS内部已经给我们提供了现成的实现:Readonly / Partial</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> MyType2 = Readonly&lt;TestInterface1&gt;</span><br><span class="line"><span class="keyword">type</span> MyType3 = Partial&lt;TestInterface1&gt;</span><br><span class="line"><span class="keyword">type</span> MyType4 = Partial&lt;Readonly&lt;TestInterface1&gt;&gt;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p>Pick映射类型:将原有类型中的部分内容映射到新类型中</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> TestInterface &#123;</span><br><span class="line">    name:<span class="built_in">string</span>;</span><br><span class="line">    age:<span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> MyType = Pick&lt;TestInterface, <span class="string">'name'</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Record映射类型:他会将一个类型的所有属性值都映射到另一个类型上并创造一个新的类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Animal = <span class="string">'person'</span> | <span class="string">'dog'</span> | <span class="string">'cat'</span>;</span><br><span class="line"><span class="keyword">interface</span> TestInterface &#123;</span><br><span class="line">    name:<span class="built_in">string</span>;</span><br><span class="line">    age:<span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> MyType = Record&lt;Animal, TestInterface&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> res:MyType = &#123;</span><br><span class="line">    person:&#123;</span><br><span class="line">        name:<span class="string">'zs'</span>,</span><br><span class="line">        age:<span class="number">18</span></span><br><span class="line">    &#125;,</span><br><span class="line">    dog:&#123;</span><br><span class="line">        name:<span class="string">'wc'</span>,</span><br><span class="line">        age:<span class="number">3</span></span><br><span class="line">    &#125;,</span><br><span class="line">    cat:&#123;</span><br><span class="line">        name:<span class="string">'mm'</span>,</span><br><span class="line">        age:<span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="分布式条件类型"><a href="#分布式条件类型" class="headerlink" title="分布式条件类型"></a>分布式条件类型</h5><ol>
<li><p>条件类型(三目运算)</p>
<p>判断前面一个类型是否是后面一个类型或者继承于后面一个类型</p>
<p>如果是就返回第一个结果, 如果不是就返回第二个结果</p>
<p>语法: <code>T extends U ? X : Y;</code></p>
</li>
<li><p>分布式条件类型?</p>
<p>被检测类型是一个联合类型的时候, 该条件类型就被称之为分布式条件类型</p>
<ul>
<li><p>从T中剔除可以赋值给U的类型。 Exclude</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> MyType&lt;T, U&gt; = T <span class="keyword">extends</span> U ? never : T;</span><br><span class="line"><span class="keyword">type</span> res = MyType&lt;<span class="built_in">string</span> | <span class="built_in">number</span> | <span class="built_in">boolean</span>, <span class="built_in">number</span>&gt;</span><br><span class="line"><span class="keyword">type</span> res = Exclude&lt;<span class="built_in">string</span> | <span class="built_in">number</span> | <span class="built_in">boolean</span>, <span class="built_in">number</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>提取T中可以赋值给U的类型。 Extract</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> res = Extract&lt;<span class="built_in">string</span> | <span class="built_in">number</span> | <span class="built_in">boolean</span>, <span class="built_in">number</span> | <span class="built_in">string</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>从T中剔除null和undefined。 NonNullable</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> res = NonNullable&lt;<span class="built_in">string</span> | <span class="literal">null</span> | <span class="built_in">boolean</span> | <span class="literal">undefined</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取函数返回值类型。 ReturnType</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> res = ReturnType&lt;<span class="function">(<span class="params">(<span class="params"></span>)=&gt;<span class="built_in">number</span></span>)&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>获取一个类的构造函数参数组成的元组类型ConstructorParameters</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Person &#123;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params">name:<span class="built_in">string</span>, age:<span class="built_in">number</span></span>)&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> res = ConstructorParameters&lt;<span class="keyword">typeof</span> Person&gt;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>获得函数的参数类型组成的元组类型。 Parameters</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">say</span>(<span class="params">name:<span class="built_in">string</span>, age:<span class="built_in">number</span>, gender:<span class="built_in">boolean</span></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> res = Parameters&lt;<span class="keyword">typeof</span> say&gt;;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="infer关键字"><a href="#infer关键字" class="headerlink" title="infer关键字"></a>infer关键字</h5><p>条件类型提供了一个infer关键字, 可以让我们在条件类型中定义新的类型</p>
<p>需求: 定义一个类型, 如果传入的是数组, 就返回数组的元素类型,</p>
<p>​         如果传入的是普通类型, 则直接返回这个类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> MyType&lt;T&gt; = T <span class="keyword">extends</span> <span class="built_in">any</span>[] ? T[<span class="built_in">number</span>] : T;</span><br><span class="line"><span class="keyword">type</span> res = MyType&lt;<span class="built_in">string</span>[]&gt;;</span><br><span class="line"><span class="keyword">type</span> res = MyType&lt;<span class="built_in">number</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MyType&lt;T&gt; = T <span class="keyword">extends</span> <span class="built_in">Array</span>&lt;infer U&gt; ? U : T;</span><br><span class="line"><span class="keyword">type</span> res = MyType&lt;<span class="built_in">string</span>[]&gt;;</span><br><span class="line"><span class="keyword">type</span> res = MyType&lt;<span class="built_in">number</span>&gt;;</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://nini-hub.github.io/2020/12/09/Express%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="妮妮妮">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/09/Express%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/" class="post-title-link" itemprop="url">Express入门学习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">نُشر في</span>
              

              <time title="أُنشأ: 2020-12-09 14:15:53 / عُدل: 16:12:03" itemprop="dateCreated datePublished" datetime="2020-12-09T14:15:53+08:00">2020-12-09</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="Express介绍"><a href="#Express介绍" class="headerlink" title="Express介绍"></a>Express介绍</h3><ol>
<li><p>什么是Express?</p>
<p>Express是一个基于NodeJS的Web Server开发框架, 能够帮助我们快速的搭建Web服务器</p>
</li>
<li><p>为什么需要Express?</p>
<ul>
<li><p>利用原生的NodeJS开发Web服务器,</p>
<p>我们需要处理很多繁琐且没有技术含量的内容</p>
<p>例如: 获取路由-&gt;解析路由-&gt;分配路由-&gt;处理路由等</p>
<p>但是有了Express之后, 就能帮助我们省去大量繁琐的环节, 让我们只用关注核心业务逻辑</p>
</li>
<li><p>利用原生的NodeJS开发Web服务器,</p>
<p>我们需要自己手动去实现静态/动态资源处理, get/post参数的解析, cookie的解析, 日志处理等</p>
<p>但是有了Express之后, 已经有现成的插件帮我们实现了上述功能</p>
</li>
<li><p>所以作为单身的程序猿(媛), 如果你还想留一些时间去约会, 那么Express是你的最佳选择</p>
</li>
</ul>
</li>
<li><p>永不过时的Express</p>
<ul>
<li><p>Express最早的版本是在2010年发布的, 目前最新的版本是5.0是在2015年左右发布的</p>
</li>
<li><p>虽然Express是一个古老的框架, 但是它并没有过时，因为</p>
<ul>
<li>公司老项目仍然在使用</li>
<li>目前比较火的KOA就是Express原班人马打造的(几乎有这相同的API)</li>
<li>目前比较火的EggJS就是KOA打造的</li>
</ul>
<p>所以</p>
<ul>
<li>学会Express能够帮助你很好的维护公司的老项目</li>
<li>学会Express能够帮助你更快的学习KOA和EggJS</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><ol>
<li><p>如何使用Express?</p>
<ul>
<li><p>手动安装手动配置</p>
</li>
<li><p>利用Express脚手架工具安装使用(Express-generator)</p>
</li>
</ul>
</li>
<li><p>手动安装手动配置</p>
<p><a href="https://www.npmjs.com/package/express" target="_blank" rel="noopener">https://www.npmjs.com/package/express</a></p>
</li>
</ol>
<h4 id="手动安装手动配置"><a href="#手动安装手动配置" class="headerlink" title="手动安装手动配置"></a>手动安装手动配置</h4><h5 id="基本使用-1"><a href="#基本使用-1" class="headerlink" title="基本使用"></a>基本使用</h5><ol>
<li><p><code>npm init &amp;&amp; npm install express</code></p>
</li>
<li><p>app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.导入express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.调用express方法, 创建服务端实例对象</span></span><br><span class="line"><span class="keyword">const</span> app = express()</span><br><span class="line">app.get(<span class="string">'/'</span>, (req, res, next)=&gt;&#123;</span><br><span class="line">    res.writeHead(<span class="number">200</span>, &#123;</span><br><span class="line">        <span class="string">'Content-Type'</span>: <span class="string">'text/plain; charset=utf-8;'</span></span><br><span class="line">    &#125;);</span><br><span class="line">    res.end(<span class="string">'www.baidu.com'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.告诉服务端需要监听哪一个端口</span></span><br><span class="line">app.listen(<span class="number">3000</span>, ()=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'listen ok'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>访问<code>localhost:3000</code></p>
</li>
</ol>
<h5 id="处理静态网页"><a href="#处理静态网页" class="headerlink" title="处理静态网页"></a>处理静态网页</h5><ol>
<li><p>将静态资源public文件夹复制到项目目录下</p>
</li>
<li><p>app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.导入express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.调用express方法, 创建服务端实例对象</span></span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理静态资源</span></span><br><span class="line">app.use(express.static(path.join(__dirname, <span class="string">'public'</span>)));</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/'</span>, (req, res, next)=&gt;&#123;</span><br><span class="line">    res.writeHead(<span class="number">200</span>, &#123;</span><br><span class="line">        <span class="string">'Content-Type'</span>: <span class="string">'text/plain; charset=utf-8;'</span></span><br><span class="line">    &#125;);</span><br><span class="line">    res.end(<span class="string">'www.it666.com'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.告诉服务端需要监听哪一个端口</span></span><br><span class="line">app.listen(<span class="number">3000</span>, ()=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'listen ok'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>访问<code>localhost:3000/login.html</code></p>
</li>
</ol>
<h5 id="处理动态网页"><a href="#处理动态网页" class="headerlink" title="处理动态网页"></a>处理动态网页</h5><ol>
<li><p>讲动态网页views文件夹复制到项目目录下</p>
</li>
<li><p>安装ejs</p>
<p><code>npm install ejs</code></p>
</li>
<li><p>app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.导入express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.调用express方法, 创建服务端实例对象</span></span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理静态资源</span></span><br><span class="line">app.use(express.static(path.join(__dirname, <span class="string">'public'</span>)));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理动态资源</span></span><br><span class="line"><span class="comment">// 1.告诉express动态资源存储在什么地方</span></span><br><span class="line">app.set(<span class="string">'views'</span>, path.join(__dirname, <span class="string">'views'</span>));</span><br><span class="line"><span class="comment">// 2.告诉express动态网页使用的是什么模板引擎</span></span><br><span class="line">app.set(<span class="string">'view engine'</span>,<span class="string">'ejs'</span>)</span><br><span class="line"><span class="comment">// 3.监听请求, 返回渲染之后的动态网页</span></span><br><span class="line">app.get(<span class="string">'/'</span>, (req, res, next)=&gt;&#123;</span><br><span class="line">    <span class="comment">// 注意点: express给请求对象和影响对象添加了很多自定义的方法</span></span><br><span class="line">    res.render(<span class="string">'index'</span>, &#123;<span class="attr">msg</span>:<span class="string">'妮妮碎碎念'</span>&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.告诉服务端需要监听哪一个端口</span></span><br><span class="line">app.listen(<span class="number">3000</span>, ()=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'listen ok'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><em>报错：</em></p>
<p><code>TypeError [ERR_INVALID_ARG_TYPE]: The &quot;path&quot; argument must be of type string. Received an instance of Object</code></p>
<p><em>解决</em></p>
<p>删除node_module,重新安包</p>
</li>
</ol>
<h5 id="处理路由"><a href="#处理路由" class="headerlink" title="处理路由"></a>处理路由</h5><ul>
<li><p>方式一</p>
<p>app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过express处理路由方式一</span></span><br><span class="line">app.get(<span class="string">'/api/goods/list'</span>, (req, res, next)=&gt;&#123;</span><br><span class="line">    res.end(<span class="string">'nini.get'</span>);</span><br><span class="line">&#125;);</span><br><span class="line">app.get(<span class="string">'/api/user/login'</span>, (req, res, next)=&gt;&#123;</span><br><span class="line">    <span class="comment">// 注意点: 响应对象的json方法是express给响应对象扩展的</span></span><br><span class="line">    <span class="comment">//         这个方法会自动将对象转换成字符串之后返回</span></span><br><span class="line">    <span class="comment">//         这个方法还会自动帮助我们设置响应头</span></span><br><span class="line">    res.json(&#123;</span><br><span class="line">        name:<span class="string">'nini'</span>,</span><br><span class="line">        age:<span class="number">18</span>,</span><br><span class="line">        method: <span class="string">'get'</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.post(<span class="string">'/api/goods/detail'</span>, (req, res, next)=&gt;&#123;</span><br><span class="line">    res.end(<span class="string">'nini.detail.post'</span>);</span><br><span class="line">&#125;);</span><br><span class="line">app.post(<span class="string">'/api/user/register'</span>, (req, res, next)=&gt;&#123;</span><br><span class="line">    res.json(&#123;</span><br><span class="line">        name:<span class="string">'nini'</span>,</span><br><span class="line">        age:<span class="number">18</span>,</span><br><span class="line">        method: <span class="string">'post'</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式二</p>
<ol>
<li><p>新建router目录</p>
</li>
<li><p>router下新建user.js，goods.js</p>
<p>/router/user.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">const</span> router = express.Router();</span><br><span class="line"><span class="comment">// 会将注册的地址和当前的地址拼接在一起来匹配</span></span><br><span class="line"><span class="comment">// /api/user/login</span></span><br><span class="line">router.get(<span class="string">'/login'</span>, (req, res, next)=&gt;&#123;</span><br><span class="line">    <span class="comment">// 注意点: 响应对象的json方法是express给响应对象扩展的</span></span><br><span class="line">    <span class="comment">//         这个方法会自动将对象转换成字符串之后返回</span></span><br><span class="line">    <span class="comment">//         这个方法还会自动帮助我们设置响应头</span></span><br><span class="line">    res.json(&#123;</span><br><span class="line">        name:<span class="string">'nini'</span>,</span><br><span class="line">        age:<span class="number">18</span>,</span><br><span class="line">        method: <span class="string">'get'</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">router.post(<span class="string">'/register'</span>, (req, res, next)=&gt;&#123;</span><br><span class="line">    res.json(&#123;</span><br><span class="line">        name:<span class="string">'nini'</span>,</span><br><span class="line">        age:<span class="number">18</span>,</span><br><span class="line">        method: <span class="string">'post'</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">module</span>.exports = router;</span><br></pre></td></tr></table></figure>
</li>
<li><p>app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> userRouter = <span class="built_in">require</span>(<span class="string">'./router/user'</span>);</span><br><span class="line">...</span><br><span class="line"><span class="comment">// 通过express处理路由方式二</span></span><br><span class="line">app.use(<span class="string">'/api/user'</span>, userRouter);</span><br></pre></td></tr></table></figure>

</li>
</ol>
</li>
</ul>
<h5 id="处理请求参数"><a href="#处理请求参数" class="headerlink" title="处理请求参数"></a>处理请求参数</h5><ol>
<li><p>get请求：express会将get的请求参数转换成对象之后, 放到请求对象的query属性中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">'/get'</span>, (req, res, next)=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(req.query);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>post请求：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 告诉express能够解析 application/json类型的请求参数</span></span><br><span class="line">app.use(express.json());</span><br><span class="line"><span class="comment">// 告诉express能够解析 表单类型的请求参数 application/x-www-form-urlencoded</span></span><br><span class="line"><span class="comment">// extended: false 使用系统自带</span></span><br><span class="line">app.use(express.urlencoded(&#123;<span class="attr">extended</span>: <span class="literal">false</span>&#125;)); </span><br><span class="line"><span class="comment">// express会将解析之后, 转换成对象的post请求参数放到请求对象的body属性中</span></span><br><span class="line">app.post(<span class="string">'/post'</span>, (req, res, next)=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(req.body);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h5 id="处理cookie"><a href="#处理cookie" class="headerlink" title="处理cookie"></a>处理cookie</h5><ol>
<li><p>设置cookie</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">'/setCookie'</span>, (req, res, next)=&gt;&#123;</span><br><span class="line">    res.cookie(<span class="string">'username'</span>, <span class="string">'nini'</span>, &#123;<span class="attr">httpOnly</span>: <span class="literal">true</span>, <span class="attr">path</span>: <span class="string">'/'</span>, <span class="attr">maxAge</span>: <span class="number">10000</span>&#125;);</span><br><span class="line">    res.end();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取cookie</p>
<ul>
<li>安装插件<code>npm install cookie-parser</code></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cookieParser = <span class="built_in">require</span>(<span class="string">'cookie-parser'</span>)</span><br><span class="line">...</span><br><span class="line">app.use(cookieParser());</span><br><span class="line">app.get(<span class="string">'/getCookie'</span>, (req, res, next)=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(req.cookies);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h5 id="next方法"><a href="#next方法" class="headerlink" title="next方法"></a>next方法</h5><p>默认情况下会从上至下的匹配路由处理方法, 一旦匹配到了就会执行,</p>
<p>执行完毕之后如果没有调用next就停止,</p>
<p>执行完毕之后如果调用了next就继续向下匹配</p>
<p>通过next方法, 我们可以将同一个请求的多个业务逻辑拆分到不同的方法中处理</p>
<p>这样可以提升代码的可读性和可维护性, 以及保证代码的单一性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">'/api/user/info'</span>,</span><br><span class="line">    (req, res, next)=&gt;&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'验证用户是否登陆'</span>);</span><br><span class="line">        next();</span><br><span class="line">    &#125;,</span><br><span class="line">    (req, res, next)=&gt;&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'用户已经登陆, 可以查看用户信息'</span>);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<h5 id="处理错误"><a href="#处理错误" class="headerlink" title="处理错误"></a>处理错误</h5><ol>
<li><p>安装createError</p>
<p><code>npm install createError</code></p>
</li>
<li><p>app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> createError = <span class="built_in">require</span>(<span class="string">'http-errors'</span>);</span><br><span class="line">...</span><br><span class="line"><span class="comment">// express错误处理</span></span><br><span class="line">app.get(<span class="string">'/api/user/login'</span>, (req, res, next)=&gt;&#123;</span><br><span class="line">    res.end(<span class="string">'login'</span>);</span><br><span class="line">&#125;);</span><br><span class="line">app.get(<span class="string">'/api/user/register'</span>, (req, res, next)=&gt;&#123;</span><br><span class="line">    res.end(<span class="string">'register'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">由于在处理请求的时候会从上至下的匹配</span></span><br><span class="line"><span class="comment">由于前面的处理方法都没有调用next方法, 所以处理完了就不会再继续向下匹配了</span></span><br><span class="line"><span class="comment">由于use没有指定路由地址, 由于use既可以处理get请求, 又可以处理post请求</span></span><br><span class="line"><span class="comment">所以只要前面的路由都没有匹配到, 就会执行下面的use</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line">app.use(<span class="function">(<span class="params">req, res, next</span>)=&gt;</span>&#123;</span><br><span class="line">    next(createError(<span class="number">404</span>));</span><br><span class="line">&#125;);</span><br><span class="line">app.use(<span class="function">(<span class="params">err, req, res, next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err.status, err.message);</span><br><span class="line">    res.end(err.message);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h5 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h5><ol>
<li><p>什么是中间件?</p>
<ul>
<li>中间件的本质就是一个函数, 这个函数接收3个参数request请求对象、response响应对象、next函数</li>
<li>当请求进来，会从第一个中间件开始进行匹配。如果匹配则进入，如果不匹配，则向后依次对比匹配</li>
</ul>
</li>
<li><p>中间件的作用?</p>
</li>
</ol>
<ul>
<li>将一个请求的处理过程，分发到多个环节中，目的效率高，便于维护。即每个环节专门干一件事</li>
</ul>
<ol start="3">
<li><p>中间件的分类</p>
<ul>
<li><p>应用级别中间件</p>
<p>绑定到app实例上的中间件</p>
<p>例如: app.get / app.post</p>
</li>
<li><p>路由级别中间件</p>
<p>绑定到router实例上的中间件</p>
<p>例如: router.get / router.post</p>
</li>
<li><p>错误处理中间件</p>
<p>与其他中间件函数的定义基本相同，</p>
<p>不同之处在于错误处理函数多了一个变量：err，即它有4个变量：err, req, res, next</p>
</li>
<li><p>内置中间件</p>
<p>express.static()、express.json()、express.urlencoded()、…</p>
</li>
<li><p>第三方中间件</p>
<p>cookie-parser、…</p>
</li>
</ul>
</li>
</ol>
<h4 id="脚手架使用"><a href="#脚手架使用" class="headerlink" title="脚手架使用"></a>脚手架使用</h4><ol>
<li><p>全局安装express-generator</p>
<p><code>npm install -g express-generator</code></p>
</li>
<li><p><code>express demo</code></p>
</li>
<li><p><code>cd demo &amp;&amp; npm install</code></p>
</li>
<li><p>为方便调试，继续安装nodemon、cross-env</p>
<p><code>npm install nodemon cross-env</code></p>
</li>
<li><p>目录结构介绍</p>
<ul>
<li><p>bin/<a href="http://www.js：服务端配置文件（创建服务端实例以及设置监听的端口）">www.js：服务端配置文件（创建服务端实例以及设置监听的端口）</a></p>
</li>
<li><p>node_module：依赖</p>
</li>
<li><p>public：静态资源</p>
</li>
<li><p>routes：处理路由的文件</p>
</li>
<li><p>views：存放动态网页</p>
</li>
<li><p>app.js：编写业务逻辑</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入了一些第三方的模块</span></span><br><span class="line"><span class="keyword">var</span> createError = <span class="built_in">require</span>(<span class="string">'http-errors'</span>);</span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">var</span> cookieParser = <span class="built_in">require</span>(<span class="string">'cookie-parser'</span>);</span><br><span class="line"><span class="keyword">var</span> logger = <span class="built_in">require</span>(<span class="string">'morgan'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入了处理路由的模块</span></span><br><span class="line"><span class="keyword">var</span> indexRouter = <span class="built_in">require</span>(<span class="string">'./routes/index'</span>);</span><br><span class="line"><span class="keyword">var</span> usersRouter = <span class="built_in">require</span>(<span class="string">'./routes/users'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建了服务端实例对象</span></span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理动态网页</span></span><br><span class="line">app.set(<span class="string">'views'</span>, path.join(__dirname, <span class="string">'views'</span>));</span><br><span class="line">app.set(<span class="string">'view engine'</span>, <span class="string">'jade'</span>);</span><br><span class="line"></span><br><span class="line">app.use(logger(<span class="string">'dev'</span>));</span><br><span class="line"><span class="comment">// 处理post请求参数</span></span><br><span class="line">app.use(express.json());</span><br><span class="line">app.use(express.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;));</span><br><span class="line"><span class="comment">// 解析cookie</span></span><br><span class="line">app.use(cookieParser());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理静态网页</span></span><br><span class="line">app.use(express.static(path.join(__dirname, <span class="string">'public'</span>)));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册处理路由模块</span></span><br><span class="line">app.use(<span class="string">'/'</span>, indexRouter);</span><br><span class="line">app.use(<span class="string">'/users'</span>, usersRouter);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理错误</span></span><br><span class="line"><span class="comment">// catch 404 and forward to error handler</span></span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  next(createError(<span class="number">404</span>));</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// error handler</span></span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span>(<span class="params">err, req, res, next</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// set locals, only providing error in development</span></span><br><span class="line">  res.locals.message = err.message;</span><br><span class="line">  res.locals.error = req.app.get(<span class="string">'env'</span>) === <span class="string">'development'</span> ? err : &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// render the error page</span></span><br><span class="line">  res.status(err.status || <span class="number">500</span>);</span><br><span class="line">  res.render(<span class="string">'error'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = app;</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://nini-hub.github.io/2020/12/07/%E6%8E%8C%E6%8F%A1%E5%B8%B8%E8%A7%81%E7%9A%84%E4%B8%89%E7%A7%8D%E7%BD%91%E9%A1%B5%E6%B8%B2%E6%9F%93%E6%96%B9%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="妮妮妮">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/07/%E6%8E%8C%E6%8F%A1%E5%B8%B8%E8%A7%81%E7%9A%84%E4%B8%89%E7%A7%8D%E7%BD%91%E9%A1%B5%E6%B8%B2%E6%9F%93%E6%96%B9%E5%BC%8F/" class="post-title-link" itemprop="url">掌握常见的三种网页渲染方式</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">نُشر في</span>
              

              <time title="أُنشأ: 2020-12-07 14:38:20 / عُدل: 14:46:26" itemprop="dateCreated datePublished" datetime="2020-12-07T14:38:20+08:00">2020-12-07</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="单页Web应用（SPA-Single-Page-web-Application）"><a href="#单页Web应用（SPA-Single-Page-web-Application）" class="headerlink" title="单页Web应用（SPA - Single Page web Application）"></a>单页Web应用（SPA - Single Page web Application）</h3><p>理解：只有一个HTML文件的Web应用, 我们就称之为单页Web应用, 就称之为SPA应用</p>
<h4 id="SPA的特点"><a href="#SPA的特点" class="headerlink" title="SPA的特点"></a>SPA的特点</h4><ol>
<li><p>SPA应用只有一个HTML文件, 所有的内容其实都在这个页面中呈现的</p>
</li>
<li><p>SPA应用只会加载一次HTML文件, 不会因为用户的操作而进行页面的重新加载</p>
</li>
<li><p>当用户与应用程序交互时, 是通过动态更新页面内容的方式来呈现不同的内容</p>
</li>
</ol>
<h4 id="SPA优点"><a href="#SPA优点" class="headerlink" title="SPA优点"></a>SPA优点</h4><ol>
<li><p>有良好的交互体验</p>
<p>不会重新加载整个网页, 只是局部更新</p>
</li>
<li><p>前后端分离开发</p>
<p>前端负责页面呈现和交互, 后端负责数据</p>
</li>
<li><p>减轻服务器压力</p>
<p>只用处理数据不用处理界面</p>
</li>
<li><p>共用一套后端程序代码</p>
</li>
</ol>
<h4 id="SPA缺点"><a href="#SPA缺点" class="headerlink" title="SPA缺点"></a>SPA缺点</h4><ol>
<li><p>SEO难度较高</p>
<p>只有一个界面, 无法针对不同的内容编写不同的SEO信息</p>
</li>
<li><p>初次加载耗时多</p>
<p>为实现单页Web应用功能及显示效果，需要在加载页面的时候将所有JavaScript、CSS统一加载，</p>
</li>
</ol>
<h3 id="如何解决单页面应用的SEO困难问题"><a href="#如何解决单页面应用的SEO困难问题" class="headerlink" title="如何解决单页面应用的SEO困难问题?"></a>如何解决单页面应用的SEO困难问题?</h3><p>解决这个问题之前首先我们需要了解常见的三种网页渲染方式</p>
<h4 id="客户端渲染-CSR-Client-Side-Render"><a href="#客户端渲染-CSR-Client-Side-Render" class="headerlink" title="客户端渲染(CSR - Client Side Render)"></a>客户端渲染(CSR - Client Side Render)</h4><p>后端只提供数据，前端做视图和交互逻辑(SPA应用就是典型的客户端渲染)</p>
<h5 id="客户端渲染过程"><a href="#客户端渲染过程" class="headerlink" title="客户端渲染过程"></a>客户端渲染过程</h5><ol>
<li><p>客户端请求html (请求)</p>
</li>
<li><p>服务端返回html</p>
</li>
<li><p>客户端渲染HTML,找到依赖的JS/CSS文件</p>
</li>
<li><p>客户端请求对应的JS/CSS文件 (请求)</p>
</li>
<li><p>服务端返回对应的JS/CSS文件</p>
</li>
<li><p>客户端等待JS/CSS文件下载完成</p>
</li>
<li><p>客户端加载并初始化下载好的JS文件</p>
</li>
<li><p>客户端执行JS代码向后端请求数据 (请求)</p>
</li>
<li><p>服务端返回数据</p>
</li>
<li><p>客户端利用服务端返回的数据填充网页</p>
</li>
</ol>
<h5 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h5><p><strong>最大优点:</strong> 交互体验好可以做局部更新</p>
<p><strong>最大缺点:</strong> 首屏加载慢(因为要等到HTML下载完才会去下载JS/CSS, 要等到JS下载完初始化完才会去获取数据),</p>
<h4 id="服务端渲染-SSR-Server-Side-Render"><a href="#服务端渲染-SSR-Server-Side-Render" class="headerlink" title="服务端渲染(SSR - Server Side Render)"></a>服务端渲染(SSR - Server Side Render)</h4><p>后端既提供数据又提供视图和交互逻辑</p>
<p>也就是服务器接到客户端请求之后，找到对应的数据并根据找到的数据生成对应的视图</p>
<p>然后将包含数据的视图一次性发给客户端，客户端直接将渲染即可</p>
<h5 id="服务端渲染过程"><a href="#服务端渲染过程" class="headerlink" title="服务端渲染过程"></a>服务端渲染过程</h5><ol>
<li><p>客户端请求html (请求)</p>
</li>
<li><p>服务端内部查找对应的html文件和数据</p>
</li>
<li><p>服务器内部根据数据html文件和数据生成完整网页</p>
</li>
<li><p>服务端返回完整网页</p>
</li>
<li><p>客户端渲染HTML,找到依赖的JS/CSS文件</p>
</li>
<li><p>客户端请求对应的JS/CSS文件 (请求)</p>
</li>
<li><p>客户端等待JS/CSS文件下载完成</p>
</li>
<li><p>客户直接展示网页</p>
</li>
</ol>
<h5 id="优缺点-1"><a href="#优缺点-1" class="headerlink" title="优缺点"></a>优缺点</h5><p><strong>最大优点:</strong> 首屏加载快(因为服务器返回的网页已经包含数据, 所以之下载完JS/CSS就可以直接渲染)</p>
<p>​     每次请求返回的都是一个独立完成的网页, 更利于SEO</p>
<p><strong>最大缺点:</strong>网络传输数据量大</p>
<h4 id="预渲染"><a href="#预渲染" class="headerlink" title="预渲染"></a>预渲染</h4><p>无需服务器实时动态编译，采用预渲染，在构建时针对特定路由简单的生成静态HTML文件</p>
<p>本质就是客户端渲染, 只不过和SPA不同的是预渲染有多个界面</p>
<h5 id="优缺点-2"><a href="#优缺点-2" class="headerlink" title="优缺点"></a>优缺点</h5><p><strong>最大优点:</strong> 由于有多个界面, 所以更利于SEO</p>
<p><strong>最大缺点:</strong> 首屏加载慢, 预编译会非常的慢</p>
<h4 id="如何选择"><a href="#如何选择" class="headerlink" title="如何选择"></a>如何选择</h4><ol>
<li><p>注重SEO的新闻、电商网站，建议采用服务器端渲染</p>
</li>
<li><p>强交互的页面，不注重SEO，采用客户端渲染</p>
</li>
<li><p>两者之间, 只需改善少数页面的SEO，采用预渲染</p>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://nini-hub.github.io/2020/11/11/%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB+%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BA%91%E7%AB%AF%E5%BC%80%E5%8F%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="妮妮妮">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/11/%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB+%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BA%91%E7%AB%AF%E5%BC%80%E5%8F%91/" class="post-title-link" itemprop="url">图像识别+小程序云端开发</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">نُشر في</span>

              <time title="أُنشأ: 2020-11-11 16:04:08" itemprop="dateCreated datePublished" datetime="2020-11-11T16:04:08+08:00">2020-11-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">عُدل في</span>
                <time title="عُدل: 2020-11-12 16:36:17" itemprop="dateModified" datetime="2020-11-12T16:36:17+08:00">2020-11-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ol>
<li><p>注册小程序个人账号，获取appid</p>
<p><a href="https://mp.weixin.qq.com/" target="_blank" rel="noopener">https://mp.weixin.qq.com/</a></p>
</li>
<li><p>微信开发者工具新建项目，后端服务选择<strong>小程序云开发</strong></p>
<ul>
<li><p>初始化后，会提示</p>
<p><code>Error: invalid scope</code> 没有权限，请先开通云服务</p>
<p>这时候需要点击左侧 <strong>云开发</strong>，开通云开发。首次开通云环境后，需等待大约 10 分钟方可正常使用云 API，在此期间官方后台服务正在做准备服务，在项目结构目录中<code>cloudfunctions</code>后会接上你的云开发环境名称即可视为成功</p>
</li>
<li><p>若提示</p>
<p><code>cloud init error: Error: socket hang up</code>可无视，可能是网速过慢，刷新重新进入即可</p>
</li>
</ul>
</li>
<li><p>简单构建页面，可选择拍摄上传图片/本地相册上传图片</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"title-container"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span>猜猜我是个啥<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"btns"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn"</span>  <span class="attr">data-Index</span>=<span class="string">"0"</span> <span class="attr">bindtap</span>=<span class="string">"doUpload"</span>&gt;</span></span><br><span class="line">      拍摄</span><br><span class="line">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn"</span> <span class="attr">data-Index</span>=<span class="string">"1"</span> <span class="attr">bindtap</span>=<span class="string">"doUpload"</span>&gt;</span></span><br><span class="line">      本地相册</span><br><span class="line">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>使用<code>wx.chooseImage</code>进行图片选择，<code>wx.cloud.uploadFile</code>进行图片上传至云存储</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">wx.chooseImage(&#123;</span><br><span class="line">      count:<span class="number">1</span>,</span><br><span class="line">      sizeType: [<span class="string">'original'</span>,<span class="string">'compressed'</span>],</span><br><span class="line">      sourceType: [sourceType],</span><br><span class="line">      success: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(res)</span><br><span class="line">        <span class="keyword">let</span> filePath = res.tempFilePaths[<span class="number">0</span>];</span><br><span class="line">          <span class="comment">// animal为云开发 存储 中 新建的文件夹名称</span></span><br><span class="line">        <span class="keyword">const</span> cloudPath = <span class="string">`animal/<span class="subst">$&#123;<span class="built_in">Date</span>.now()&#125;</span><span class="subst">$&#123;filePath.match(<span class="regexp">/\.[^.]+?$/</span>)&#125;</span>`</span></span><br><span class="line">        <span class="built_in">console</span>.log(cloudPath);</span><br><span class="line">        wx.cloud.uploadFile(&#123;</span><br><span class="line">          cloudPath,</span><br><span class="line">          filePath,</span><br><span class="line">          success:<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(res)</span><br><span class="line">            wx.navigateTo(&#123;</span><br><span class="line">              url: <span class="string">`../detail/detail?pic=<span class="subst">$&#123;filePath&#125;</span>&amp;&amp;fileID=<span class="subst">$&#123;res.fileID&#125;</span>`</span></span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>



</li>
</ol>
<ol start="5">
<li><p>新建node.js云函数</p>
<p>在cloudfunctions下新建一个云函数（注意命名必须唯一）,修改index.js</p>
<ul>
<li><p>引入云函数入口文件</p>
<p><code>const cloud = require(&quot;wx-server-sdk&quot;);</code></p>
</li>
<li><p>引入<code>baidu-aip-sdk</code>，（使用前先进入此云函数所在目录安装这个包，此处已安装好）</p>
<p><code>var AipImageClassifyClient = require(&quot;baidu-aip-sdk&quot;).imageClassify;</code></p>
</li>
<li><p>设置APPID/AK/SK</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> APP_ID = <span class="string">"your APP_ID"</span>;</span><br><span class="line"><span class="keyword">var</span> API_KEY = <span class="string">"your API_KEY"</span>;</span><br><span class="line"><span class="keyword">var</span> SECRET_KEY = <span class="string">"your SECRET_KEY"</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>新建一个对象，建议只保存一个对象调用服务接口,并初始化cloud</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> client = <span class="keyword">new</span> AipImageClassifyClient(APP_ID, API_KEY, SECRET_KEY);</span><br><span class="line"></span><br><span class="line">cloud.init();</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写云函数入口函数，使用<code>cloud.downloadFile</code>下载图片，下载后转为base64，进而使用<code>client.animalDetect</code>进行图像识别，并将结果返回（附加百科词条）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">exports.main = <span class="keyword">async</span> (event, context) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; fileID &#125; = event;</span><br><span class="line">  <span class="comment">//通过fileID取这张图片</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> cloud.downloadFile(&#123;</span><br><span class="line">    fileID: fileID</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> buffer = res.fileContent;</span><br><span class="line">  <span class="keyword">let</span> image = buffer.toString(<span class="string">"base64"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> info = <span class="keyword">await</span> client.animalDetect(image,&#123;<span class="attr">baike_num</span>:<span class="number">5</span>&#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    info</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ol>
<h5 id="一坑"><a href="#一坑" class="headerlink" title="一坑"></a>一坑</h5><p><strong>注意：写好的云函数记得右击上传并部署</strong></p>
<ol start="6">
<li><p>识别结果页面</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:if</span>=<span class="string">"&#123;&#123;imgUrl&#125;&#125;"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">"&#123;&#123;imgUrl&#125;&#125;"</span> <span class="attr">mode</span>=<span class="string">"aspectFit"</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"title-container"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span>识别结果<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:for</span>=<span class="string">"&#123;&#123;result&#125;&#125;"</span> <span class="attr">class</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"list-name"</span>&gt;</span>&#123;&#123;index+1&#125;&#125;.&#123;&#123;item.name&#125;&#125;（&#123;&#123;item.score&#125;&#125;）<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"list-baike"</span>&gt;</span>百科信息：&#123;&#123;item.baike_info.description || '暂无'&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>识别页面的入口函数</p>
<p>在文件中使用<code>wx.cloud.callFunction</code>调用云函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">onLoad: <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; pic, fileID &#125; = options;</span><br><span class="line">    <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">      imgUrl:pic</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    wx.cloud.callFunction(&#123;</span><br><span class="line">      name:<span class="string">"baidu2"</span>,</span><br><span class="line">      data:&#123;</span><br><span class="line">        fileID: fileID</span><br><span class="line">      &#125;,</span><br><span class="line">      success:<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(res,<span class="string">"baidu"</span>)</span><br><span class="line">        <span class="keyword">const</span> &#123;<span class="attr">result</span>:&#123;<span class="attr">info</span>:&#123;result&#125;&#125;&#125; = res</span><br><span class="line">        <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">          result:result</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>github地址:<a href="https://github.com/xxn-my/applet-cloud" target="_blank" rel="noopener">https://github.com/xxn-my/applet-cloud</a></p>
<p>效果图：</p>
<p><img src="https://github.com/xxn-my/applet-cloud/raw/master/temp/success.png" alt="image"></p>
<p><img src="https://github.com/xxn-my/applet-cloud/raw/master/temp/result.png" alt="image"></p>
<h5 id="二坑"><a href="#二坑" class="headerlink" title="二坑"></a>二坑</h5><p>在微信开发者工具打开终端执行npm install出现以下的提示</p>
<p><strong>无法加载文件 C:\Users\lulei\AppData\Roaming\npm\cnpm.ps1，因为在此系统上禁止运行脚本”的问题</strong></p>
<p>解决方案</p>
<p>打开Windows PowerShell，选择“以管理员身份运行”，输入<code>set-ExecutionPolicy RemoteSigned</code>，然后更改权限为A即可</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://nini-hub.github.io/2020/10/28/gatsby%E6%90%AD%E5%BB%BA%E4%BC%81%E4%B8%9A%E7%AB%99-%E6%80%BB%E7%BB%93%E7%AF%87/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="妮妮妮">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/28/gatsby%E6%90%AD%E5%BB%BA%E4%BC%81%E4%B8%9A%E7%AB%99-%E6%80%BB%E7%BB%93%E7%AF%87/" class="post-title-link" itemprop="url">gatsby搭建企业站-总结篇</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">نُشر في</span>

              <time title="أُنشأ: 2020-10-28 14:50:23" itemprop="dateCreated datePublished" datetime="2020-10-28T14:50:23+08:00">2020-10-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">عُدل في</span>
                <time title="عُدل: 2020-11-24 11:31:20" itemprop="dateModified" datetime="2020-11-24T11:31:20+08:00">2020-11-24</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="利用gatsby从零开始搭建企业站"><a href="#利用gatsby从零开始搭建企业站" class="headerlink" title="利用gatsby从零开始搭建企业站"></a>利用gatsby从零开始搭建企业站</h2><p>本篇总结包括以下内容：</p>
<ul>
<li><p>Gatsby入门</p>
<ul>
<li>开发环境搭建</li>
<li>gatsby-starter-default目录结构解析</li>
<li>添加CSS样式</li>
<li>布局组件</li>
<li>一些使用到的插件</li>
</ul>
</li>
<li><p>镜像打包-Dockerfile</p>
</li>
<li><p>静态资源上传对象存储</p>
</li>
<li><p>建立CI/CD流水线，并部署进k8s</p>
</li>
</ul>
<h3 id="Gatsby入门"><a href="#Gatsby入门" class="headerlink" title="Gatsby入门"></a>Gatsby入门</h3><h5 id="开发环境搭建"><a href="#开发环境搭建" class="headerlink" title="开发环境搭建"></a>开发环境搭建</h5><p>Gatsby CLI 可通过 npm 安装，命令行运行 <code>npm install -g gatsby-cli</code> 进行全局安装。</p>
<p>当你新建一个 Gatsby 网站时，可以基于任何一个现有的Starter:<a href="https://www.gatsbyjs.com/starters/?v=2" target="_blank" rel="noopener">https://www.gatsbyjs.com/starters/?v=2</a> </p>
<p>用以下命令结构来创建一个网站，gatsby-starter-default</p>
<p><code>gatsby new [PROJECT_NAME] https://xxxx</code></p>
<h5 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h5><ul>
<li><p>/.cache</p>
</li>
<li><p>/public：存放最终由<code>gatsby build</code>产生的静态文件，可无视。</p>
</li>
<li><p>/src：主要的程式都放在这里面，最常接触。<br>   |– /pages<br>   |– html.js</p>
</li>
<li><p>.gitignore：Git的ignore设定</p>
</li>
<li><p>gatsby-config.js：为Gatsby网站配置选项，并为项目标题，说明，插件等提供元数据。</p>
</li>
<li><p>gatsby-node.js：实施Gatsby的Node.js API，以自定义和扩展影响构建过程的默认设置</p>
</li>
<li><p>gatsby-ssr.js：使用Gatsby的服务器端渲染API自定义影响服务器端渲染的默认设置</p>
</li>
<li><p>gatsby-browser.js：使用Gatsby的浏览器API自定义和扩展影响浏览器的默认设置</p>
</li>
<li><p>package.json：NPM设定</p>
</li>
<li><p>package-lock.json, yarn.lock：NPM和yarn的锁定文件，无视。</p>
</li>
</ul>
<h5 id="添加CSS样式"><a href="#添加CSS样式" class="headerlink" title="添加CSS样式"></a>添加CSS样式</h5><ul>
<li><p>使用不带布局组件的全局CSS文件</p>
</li>
<li><p>在布局组件中使用全局样式</p>
</li>
<li><p>使用样式化的组件</p>
</li>
<li><p>使用CSS模块</p>
</li>
<li><p>使用Sass / SCSS</p>
</li>
<li><p>添加字体文件</p>
</li>
<li><p>使用emotion</p>
<p>—未完</p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://nini-hub.github.io/2020/10/22/%E5%BB%BA%E7%AB%8Bgitlab-CICD%E6%B5%81%E6%B0%B4%E7%BA%BF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="妮妮妮">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/22/%E5%BB%BA%E7%AB%8Bgitlab-CICD%E6%B5%81%E6%B0%B4%E7%BA%BF/" class="post-title-link" itemprop="url">建立CI/CD流水线</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">نُشر في</span>

              <time title="أُنشأ: 2020-10-22 16:22:26" itemprop="dateCreated datePublished" datetime="2020-10-22T16:22:26+08:00">2020-10-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">عُدل في</span>
                <time title="عُدل: 2020-10-26 09:21:43" itemprop="dateModified" datetime="2020-10-26T09:21:43+08:00">2020-10-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h5 id="小菜鸡来写gitlab-ci了"><a href="#小菜鸡来写gitlab-ci了" class="headerlink" title="小菜鸡来写gitlab-ci了"></a>小菜鸡来写gitlab-ci了</h5><h5 id="历劫前补补课"><a href="#历劫前补补课" class="headerlink" title="历劫前补补课"></a>历劫前补补课</h5><h2 id="CI-CD方法论简介"><a href="#CI-CD方法论简介" class="headerlink" title="CI / CD方法论简介"></a>CI / CD方法论简介</h2><p>软件开发的连续方法基于自动执行脚本，以最大程度地减少在开发应用程序时引入错误的机会。从开发新代码到部署新代码，他们几乎不需要人工干预，甚至根本不需要干预。</p>
<p>GitLab CI / CD是GitLab内置的功能强大的工具，它使您可以将所有连续方法（连续集成，交付和部署）应用于软件，而无需第三方应用程序或集成。</p>
<h5 id="一些常用的关键字"><a href="#一些常用的关键字" class="headerlink" title="一些常用的关键字"></a>一些常用的关键字</h5><table>
<thead>
<tr>
<th align="left">关键词</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#script" target="_blank" rel="noopener"><code>script</code></a></td>
<td align="left">运行程序执行的Shell脚本。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#before_script-and-after_script" target="_blank" rel="noopener"><code>after_script</code></a></td>
<td align="left">覆盖作业后执行的一组命令。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#allow_failure" target="_blank" rel="noopener"><code>allow_failure</code></a></td>
<td align="left">允许作业失败。失败的作业不会影响提交状态。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#artifacts" target="_blank" rel="noopener"><code>artifacts</code></a></td>
<td align="left">成功时附加到作业的文件和目录列表。也可用：<code>artifacts:paths</code>，<code>artifacts:exclude</code>，<code>artifacts:expose_as</code>，<code>artifacts:name</code>，<code>artifacts:untracked</code>，<code>artifacts:when</code>，<code>artifacts:expire_in</code>，和<code>artifacts:reports</code>。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#before_script-and-after_script" target="_blank" rel="noopener"><code>before_script</code></a></td>
<td align="left">覆盖作业之前执行的一组命令。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#cache" target="_blank" rel="noopener"><code>cache</code></a></td>
<td align="left">在后续运行之间应缓存的文件列表。也可用：<code>cache:paths</code>，<code>cache:key</code>，<code>cache:untracked</code>，<code>cache:when</code>，和<code>cache:policy</code>。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#coverage" target="_blank" rel="noopener"><code>coverage</code></a></td>
<td align="left">给定作业的代码覆盖率设置。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#dependencies" target="_blank" rel="noopener"><code>dependencies</code></a></td>
<td align="left">通过提供要从中获取工件的作业列表，限制将哪些工件传递给特定作业。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#environment" target="_blank" rel="noopener"><code>environment</code></a></td>
<td align="left">作业部署到的环境的名称。也可用：<code>environment:name</code>，<code>environment:url</code>，<code>environment:on_stop</code>，<code>environment:auto_stop_in</code>，和<code>environment:action</code>。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#onlyexcept-basic" target="_blank" rel="noopener"><code>except</code></a></td>
<td align="left">限制不创建作业的时间。也可用：<a href="https://docs.gitlab.com/ee/ci/yaml/README.html#onlyexcept-advanced" target="_blank" rel="noopener"><code>except:refs</code>，<code>except:kubernetes</code>，<code>except:variables</code>，和<code>except:changes</code></a>。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#extends" target="_blank" rel="noopener"><code>extends</code></a></td>
<td align="left">该作业继承的配置条目。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#image" target="_blank" rel="noopener"><code>image</code></a></td>
<td align="left">使用Docker映像 也可用：<code>image:name</code>和<code>image:entrypoint</code>。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#include" target="_blank" rel="noopener"><code>include</code></a></td>
<td align="left">允许此作业包括外部YAML文件。也可用：<code>include:local</code>，<code>include:file</code>，<code>include:template</code>，和<code>include:remote</code>。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#onlyexcept-basic" target="_blank" rel="noopener"><code>only</code></a></td>
<td align="left">限制创建作业的时间。也可用：<a href="https://docs.gitlab.com/ee/ci/yaml/README.html#onlyexcept-advanced" target="_blank" rel="noopener"><code>only:refs</code>，<code>only:kubernetes</code>，<code>only:variables</code>，和<code>only:changes</code></a>。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#parallel" target="_blank" rel="noopener"><code>parallel</code></a></td>
<td align="left">多少个作业实例应并行运行。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#release" target="_blank" rel="noopener"><code>release</code></a></td>
<td align="left">指示运行程序生成<a href="https://docs.gitlab.com/ee/user/project/releases/index.html" target="_blank" rel="noopener">Release</a>对象。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#retry" target="_blank" rel="noopener"><code>retry</code></a></td>
<td align="left">发生故障时可以自动重试作业的时间和次数。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#rules" target="_blank" rel="noopener"><code>rules</code></a></td>
<td align="left">评估和确定作业的所选属性以及是否创建作业的条件列表。不能与<code>only</code>/一起使用<code>except</code>。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#stage" target="_blank" rel="noopener"><code>stage</code></a></td>
<td align="left">定义一个作业阶段（默认值：）<code>test</code>。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#tags" target="_blank" rel="noopener"><code>tags</code></a></td>
<td align="left">用于选择runner的标签列表。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#trigger" target="_blank" rel="noopener"><code>trigger</code></a></td>
<td align="left">定义下游管道触发器。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#variables" target="_blank" rel="noopener"><code>variables</code></a></td>
<td align="left">在作业级别上定义作业变量。</td>
</tr>
<tr>
<td align="left"><a href="https://docs.gitlab.com/ee/ci/yaml/README.html#when" target="_blank" rel="noopener"><code>when</code></a></td>
<td align="left">什么时候开始工作。也可用：<code>when:manual</code>和<code>when:delayed</code>。</td>
</tr>
</tbody></table>
<p>首先，从基本元素job开始</p>
<ul>
<li>首先写个默认image</li>
</ul>
<p>这个image在我的理解下是 之后的每个作业运行的环境,后续作业中没有定义image的，以此image为准</p>
<ul>
<li>编写before_script</li>
</ul>
<p>定义项目推送的镜像</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">before_script:</span><br><span class="line">  - IMAGE_TAG=$&#123;IMAGE&#125;:$&#123;CI_COMMIT_SHORT_SHA&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>其次可以写一写stages</li>
</ul>
<p>例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">stages:</span><br><span class="line">    - build</span><br><span class="line">    - test</span><br><span class="line">    - dockerize</span><br><span class="line">    - deploy</span><br></pre></td></tr></table></figure>

<ul>
<li><p>接下来开始编写job</p>
<ul>
<li>首先写一个阶段为build的作业</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">app: </span><br><span class="line">  stage: build</span><br><span class="line">  cache:</span><br><span class="line">    key: </span><br><span class="line">      files:</span><br><span class="line">        - package.json</span><br><span class="line">        - yarn.lock</span><br><span class="line">    paths:</span><br><span class="line">      - public</span><br><span class="line">      - node_modules</span><br><span class="line">  script:</span><br><span class="line">      - <span class="keyword">export</span> $REGISTRY_PASSWORD</span><br><span class="line">      - yarn config <span class="keyword">set</span> registry "https://registry.npm.taobao.org"</span><br><span class="line">      - if [ ! -x "node_modules" ];then</span><br><span class="line">        echo "node_modules not exist";</span><br><span class="line">        yarn install --frozen-lockfile;</span><br><span class="line">        else </span><br><span class="line">        echo "node_modules exist";  </span><br><span class="line">        fi  </span><br><span class="line">      - npm run build</span><br><span class="line">  artifacts:</span><br><span class="line">    expire_in: 1 day</span><br><span class="line">    paths:</span><br><span class="line">      - public</span><br><span class="line">      - node_modules</span><br></pre></td></tr></table></figure>

<p>以上作业的的解释如下</p>
<p>阶段：build</p>
<p>应缓存的文件列表：取到package.json和yarn.lock</p>
<p>运行程序执行的Shell脚本：</p>
<ul>
<li><p>yarn配置国内镜像，</p>
</li>
<li><p>执行yarn install</p>
</li>
<li><p>npm run build</p>
</li>
</ul>
<p>成功时附加到作业的文件和目录列表：</p>
<ul>
<li>一天</li>
<li>路径</li>
</ul>
</li>
</ul>
<p>至此build作业编写完毕，不指定特定分支，因此任何分支有提交代码都会执行这个作业</p>
<ul>
<li><p>继续编写其他作业</p>
<ul>
<li>阶段为dockerize</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">build-app-image:</span><br><span class="line">  stage: dockerize</span><br><span class="line">  cache:</span><br><span class="line">    key: </span><br><span class="line">      files:</span><br><span class="line">        - package.json</span><br><span class="line">        - yarn.lock</span><br><span class="line">    paths:</span><br><span class="line">      - public</span><br><span class="line">    policy: pull</span><br><span class="line">  script:</span><br><span class="line">    - chmod +x scripts/build.sh </span><br><span class="line">    - scripts/build.sh $CI_COMMIT_SHORT_SHA</span><br><span class="line">    - chmod +x scripts/push.sh </span><br><span class="line">    - scripts/push.sh $CI_COMMIT_SHORT_SHA</span><br><span class="line"></span><br><span class="line">    - <span class="keyword">export</span> AWS_ACCESS_KEY_ID=$ALIYUN_ACCESS_ID</span><br><span class="line">    - <span class="keyword">export</span> AWS_SECRET_ACCESS_KEY=$ALIYUN_ACCESS_SECRET</span><br><span class="line">    - npm run deploy</span><br><span class="line">  only:</span><br><span class="line">    - master</span><br><span class="line">    - develop</span><br><span class="line">    - tags</span><br></pre></td></tr></table></figure>

<p>以上作业的的解释如下</p>
<p>阶段：dockerize</p>
<p>运行程序执行的Shell脚本：</p>
<ul>
<li><p>进行镜像的build和push（其中scripts下的build.sh和push.sh均为写好的镜像打包、上传）</p>
</li>
<li><p>export oss的id和secret，执行deploy，上传对象存储</p>
</li>
</ul>
<p>仅在以下分支执行此作业：</p>
<ul>
<li>master</li>
<li>develop</li>
<li>tags</li>
</ul>
</li>
</ul>
<p>至此dockerize作业编写完毕</p>
<p>以上就是gitlab-ci.yml的学习以及实践，步署预发布版本和步署真实版本进k8s的等我看懂了<strong>deployment.yaml</strong>再来更新</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://nini-hub.github.io/2020/10/22/gatsby%E4%B8%8E%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="妮妮妮">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/22/gatsby%E4%B8%8E%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8/" class="post-title-link" itemprop="url">gatsby与对象存储</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">نُشر في</span>
              

              <time title="أُنشأ: 2020-10-22 14:59:22 / عُدل: 16:20:47" itemprop="dateCreated datePublished" datetime="2020-10-22T14:59:22+08:00">2020-10-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h5 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h5><p>用gatsby写完了一个官网，需要将静态资源上传对象存储，一开始尝试使用<code>webpack-alioss-plugin</code>，在项目中添加自定义Webpack配置，在<code>gatsby-node.js</code>中导出一个名为的函数<code>onCreateWebpackConfig</code>，去写<code>AliOSSPlugin</code>,但AliOSSPlugin与gatsby的配套不一定好，</p>
<p>最终，使用<code>gatsby-plugin-s3</code>这个插件，以将gatsby站点部署到S3存储桶</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">      resolve: <span class="string">`gatsby-plugin-s3`</span>,</span><br><span class="line">      options: &#123;</span><br><span class="line">        bucketName: <span class="string">`your-bucketName`</span>,</span><br><span class="line">        region:<span class="string">`your-region`</span>,</span><br><span class="line">        protocol: <span class="string">"https"</span>,</span><br><span class="line">        hostname: <span class="string">"your-hostname"</span>,</span><br><span class="line">        customAwsEndpointHostname: <span class="string">"your-Endpoint"</span>,</span><br><span class="line">        <span class="comment">// mergeCachingParams:true,</span></span><br><span class="line">        parallelLimit:<span class="number">100</span>,</span><br><span class="line">        params:&#123;</span><br><span class="line">          <span class="string">'static/**'</span>: &#123;</span><br><span class="line">            CacheControl: <span class="string">'public, max-age=2592000, immutable'</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="string">'*.&#123;js,css&#125;'</span>:&#123;</span><br><span class="line">            CacheControl: <span class="string">'public, max-age=2592000, immutable'</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<p><em>但是要注意，要将assetPrefix设置好，build是时候相应的要加上<code>--prefix-paths</code></em></p>
<p>这样，build完后执行<code>npx gatsby-plugin-s3 deploy --yes</code>或者进入<code>package.json</code>修改<code>script</code></p>
<p>就完成了对象存储</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="الصفحة التالية"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          المحتويات
        </li>
        <li class="sidebar-nav-overview">
          عام
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="妮妮妮"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">妮妮妮</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">المقالات</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/nini-hub" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;nini-hub" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/490201490@qq.com" title="E-Mail → 490201490@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">妮妮妮</span>
</div>
  <div class="powered-by">تطبيق الموقع <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>



        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
